<?xml version="1.0" encoding="UTF-8"?>
<!--
 * $HeadURL$
 * Copyright (c) 2003-2007 Untangle, Inc.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License, version 2,
 * as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful, but
 * AS-IS and WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE, TITLE, or
 * NONINFRINGEMENT.  See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
-->
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<!-- ===================================================================== -->
<!--                                                                       -->
<!--  Log4j Configuration for UVM                                         -->
<!--                                                                       -->
<!--     Configuration of all uvm loggers lives here.                     -->
<!--                                                                       -->
<!-- ===================================================================== -->

<!-- $Id$ -->

<!--
   | For more configuration infromation and examples see the Jakarta Log4j
   | website: http://jakarta.apache.org/log4j
 -->


<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"
                     debug="false">

  <appender name="NODELOG" class="org.apache.log4j.net.SyslogAppender">
    <param name="SyslogHost" value="localhost"/>
    <param name="Facility" value="LOCAL1"/>
    <param name="Threshold" value="ALL"/>
    <layout class="org.apache.log4j.PatternLayout">
      <param name="ConversionPattern" value="node@NodeLogFileName@: [%c{1}] &lt;%X{SessionID}&gt; %-5p %m%n"/>
    </layout>
  </appender>

  <!-- Log Emailer -->

  <appender name="EmailAppender" class="com.untangle.uvm.logging.SmtpAppender">
    <!-- Note: We do *not* specify a layout here because we must
         create it programmatically so that we can get the node
         name in there.  Instead we provide the Conversion Pattern
         here at the top level so that the SmtpAppender constructor
         can create the correct layout. -->
    <param name="LayoutConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss} [%c{1}] &lt;%X{SessionID}&gt; %-5p %m%n"/>
  </appender>

  <category name="org.apache.catalina">
    <priority value="WARN"/>
  </category>

  <!-- #      DEBUG           new session debugging -->
  <!-- #      INFO            each new session -->
  <!-- #      WARN            exceptions -->
  <category name="com.untangle.uvm.vnet.ArgonConnector">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.vnet.Dispatcher">
    <priority value="WARN"/>
  </category>

  <!-- # Session Event messages: all events delivered to node,
       logged just before delivery the delivery/execution thread. -->
  <!-- #      DEBUG          Data events -->
  <!-- #      INFO           shutdown, close, other session events. -->
  <!-- #      WARN           New session, new session request events -->
  <category name="com.untangle.uvm.vnet.SessionEvent">
    <priority value="ERROR"/> <!-- No logging by default -->
  </category>

  <!-- # Internal Session messages, -->
  <!-- #      DEBUG           session r/w state change, r/w statistics -->
  <!-- #      INFO            (currently same as WARN) -->
  <!-- #      WARN            exceptions or unusual conditions  -->
  <category name="com.untangle.uvm.vnet.Session">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.vnet.TCPSession">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.vnet.UDPSession">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.vnet.SessionTimes">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.util">
    <priority value="INFO"/>
  </category>

  <category name="com.untangle.node.token">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.router">
    <priority value="INFO"/>
  </category>

  <category name="com.untangle.node.license">
    <priority value="WARN"/>
  </category>

  <!-- for ext-impl -->
  <category name="com.untangle.uvm.license">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.adconnector">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.webfilter.BlackList">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.bandwidth">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.virus">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.clam">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.kav">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.webcache">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.spam">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.spamassassin">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.phish">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.ftp">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.http">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.mail">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.webfilter">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.ips">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.protofilter">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.sitefilter">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.branding">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.spyware">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.firewall">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node.cpd">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.node">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.node">
    <priority value="WARN"/>
  </category>

  <!-- ======================= -->
  <!-- Setup the Root category -->
  <!-- ======================= -->

  <!-- All Node logs go to individual node log files -->
  <root>
    <priority value="WARN"/>
    <appender-ref ref="NODELOG"/>
    <appender-ref ref="EmailAppender"/>
  </root>
</log4j:configuration>
