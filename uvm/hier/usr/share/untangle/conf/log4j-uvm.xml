<?xml version="1.0" encoding="UTF-8"?>
<!--
 * $HeadURL$
 * Copyright (c) 2003-2007 Untangle, Inc. 
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License, version 2,
 * as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful, but
 * AS-IS and WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE, TITLE, or
 * NONINFRINGEMENT.  See the GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
-->
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">

<!-- ===================================================================== -->
<!--                                                                       -->
<!--  Log4j Configuration for UVM                                          -->
<!--                                                                       -->
<!--     Configuration of all uvm loggers lives here.                      -->
<!--                                                                       -->
<!-- ===================================================================== -->

<!-- $Id$ -->

<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"
                     debug="false">

  <!-- ============================================== -->
  <!-- Appenders                                      -->
  <!-- ============================================== -->

  <appender name="UVMLog" class="org.apache.log4j.RollingFileAppender">
    <param name="File" value="${uvm.home}/log/uvm.log"/>
    <param name="Append" value="true"/>
    <param name="MaxFileSize" value="500KB"/>
    <param name="MaxBackupIndex" value="9"/>
    <param name="Threshold" value="ALL"/>
    <layout class="com.untangle.uvm.logging.UtPatternlayout">
      <!-- This is actually the default conversion, so we could leave it out... -->
      <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss} [%c{1}] %-5p %m%n"/>
    </layout>
  </appender>

  <appender name="REPORTER" class="org.apache.log4j.FileAppender">
    <param name="File" value="${uvm.home}/log/reporter.log"/>
    <param name="Append" value="true"/>
    <param name="Threshold" value="ALL"/>
    <layout class="com.untangle.uvm.logging.UtPatternlayout">
      <!-- This is actually the default conversion, so we could leave it out... -->
      <param name="ConversionPattern" value="%d{yyyy-MM-dd HH:mm:ss} [%c{1}] %-5p %m%n"/>
    </layout>
  </appender>

  <!-- Log Emailer -->

  <appender name="EmailAppender"
            class="com.untangle.uvm.logging.SmtpAppender">
    <!-- We use the default conversion pattern, so it's omitted. -->
  </appender>

  <!-- ============================================== -->
  <!-- Categories                                     -->
  <!-- ============================================== -->

  <category name="org.apache.catalina">
    <priority value="INFO"/>
  </category>

  <category name="org.apache.jk">
    <priority value="INFO"/>
  </category>

  <category name="org.hibernate">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.argon.SessionGlobalState">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.argon">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.jnetcap">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.jvector">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.logging">
    <priority value="WARN"/>
  </category>

  <category name="com.untangle.uvm.snmp">
    <priority value="INFO"/>
  </category>

  <!-- reports logs go *only* to a separate file -->
  <category name="com.untangle.uvm.reporting" additivity="false">
    <priority value="ALL"/>
    <appender-ref ref="REPORTER"/>
  </category>

  <category name="com.untangle.uvm.engine.RemoteReportingManagerImpl" additivity="false">
    <priority value="ALL"/>
    <appender-ref ref="REPORTER"/>
  </category>

  <category name="com.untangle.uvm.reports" additivity="false">
    <priority value="ALL"/>
    <appender-ref ref="REPORTER"/>
  </category>

  <!-- normal level for engine and following is INFO -->
  <category name="com.untangle.uvm.engine">
    <priority value="INFO"/>
  </category>

  <!-- temporary to debug startup phase network settings -->
  <category name="com.untangle.uvm.engine.SettingsManagerImpl">
    <priority value="INFO"/>
  </category>

  <category name="com.untangle.uvm.policy">
    <priority value="INFO"/>
  </category>

  <category name="com.untangle.uvm.license">
    <priority value="INFO"/>
  </category>

  <category name="com.untangle.node.util">
    <priority value="INFO"/>
  </category>

  <category name="com.mchange">
    <priority value="INFO"/>
  </category>


  <!-- ============================================== -->
  <!-- The Root Category                              -->
  <!-- ============================================== -->

  <!-- All UVM logs go to the UVMLog file -->
  <root>
    <priority value="WARN"/>
    <appender-ref ref="UVMLog"/>
    <appender-ref ref="EmailAppender"/>
  </root>
</log4j:configuration>
