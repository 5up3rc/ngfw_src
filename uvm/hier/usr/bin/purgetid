#!/bin/sh
exec >>@UVM_LOG@/schema.log 2>&1

PSQL="psql -X -U postgres --tuples-only --no-align uvm"

if [ $# != 1 ]; then
    echo "usage: $0 tid"
    exit 1
fi

tid=$1

component=$(echo "SELECT name FROM node_persistent_state WHERE tid = $tid;" | $PSQL)

script="@UVM_SCHEMA@/$component/purgetid.sql"

psql -X -U postgres -v tid="$tid" -f "$script" uvm
