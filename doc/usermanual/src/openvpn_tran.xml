<?xml version="1.0" encoding="UTF-8"?>
<chapter id="openvpn_tran">

  <title>Open VPN</title>

  <!-- Note that the "introduction" is not within a Section.  This is
       the convention we'll use
  -->
  <para>
    The Open VPN Appliance is identified by the
    <inlinemediaobject>
      <imageobject>
        <imagedata fileref="figure/openvpn/openvpn_tran_icon.png"/>
      </imageobject>
    </inlinemediaobject>
    symbol.  If the Open VPN Appliance is not installed, please refer to <xref linkend="using_adminui_appliances"/> for installation instructions.
  </para>

  <para>
    The Open VPN Appliance provides Virtual Private Network (<glossterm linkend="gloss_vpn">VPN</glossterm>) functionality from the &eg; to external machines and locations.  For an overview of VPN and the &eg; implementation, please refer to <xref linkend="openvpn_tran_overview"/>.  
  </para>

  <sect1 id="openvpn_tran_overview">
    <title>Overview</title>
    <para>
      This section serves to provide an overview of the <glossterm linkend="gloss_vpn">VPN</glossterm> implementation within the &eg;.  Although it will not discuss the general concept of a VPN in detail, we will use the following working definition during our discussion.

      <blockquote>
        <para>
          A VPN is a secure connection from a remote host or network into a protected network
        </para>
      </blockquote>

      With any VPN connection, there is a <emphasis>client</emphasis> and <emphasis>server</emphasis>.  The client connects to the server, establishing an encrypted communication channel.  Implicit is that the server is protecting network resources from another untrusted network (usualy the Internet).  The VPN connection allows the remote client to reside on an untrusted network yet access protected resources <quote>behind</quote> the VPN server.  
    </para>
    <para>
      A secure communication channel itself is of only limited value.  Once a client established a VPN connection to a server, that server then <emphasis>exports</emphasis> network resources to the client.  These are the protected machines or <glossterm linkend="gloss_subnet">subnets</glossterm>, shielded from the untrusted network but through a VPN connection.
    </para>
    <para>
      This concept of <quote>exporting</quote> resources is a subtle one.  A very simple VPN deployment may export the entire internal (protected) network to VPN clients.  This can be thought of as the VPN client simply <quote>joining</quote> the internal network from a remote location via a secure channel.  For many deployments, this may be appropriate.  In other deployments, a further level of protection may be appropriate.  For example, the most common use of VPN is employees working from home.  Many homes now have wireless networks, which are not always properly secured.  When a user establishes a VPN connection from their home, they may be exposing the corporation to any <glossterm linkend="gloss_malware">malware</glossterm> residing on their home network.  To mimimize this risk, the corporation may choose to only <emphasis>export</emphasis> the intranet server to VPN clients.  Such clients could not connect to other internal resources (file servers, printers, ERP systems) they could reach from their desk at work.
    </para>
    <para>
      Implied in the establishment of a <quote>secure</quote> connection is not only encryption (preventing evesdropping by malicious parties between the VPN client and server) but also <emphasis>authentication</emphasis>.  With the Open VPN implementation within &eg;, authentication takes place <quote>key pairs</quote>.  A discussion of Public Key Infrastructure (PKI) is beyond the scope of this document.  What is important is that there need be a key placed on each client wishing to connect to a VPN server.  This is known as <emphasis>key distribution</emphasis>.  There are two options for key distribution with the Open VPN implementation within &eg;, via email or via USB key.
      <tip>
        <para>
          What is most important in this discussion of authentication is that the key placed on each client must not be lost.  If a key is lost (for example, someone loosing their laptop) it must be invalidated.  Invalidating clients and their keys will be discussed later in this section.
        </para>
      </tip>
    </para>
    <para>
      Thus far in our discussion, we have provided examples of a remote client machine connecting to a VPN server.  It is also possible to bridge an entire remote network to a VPN server.  A common use for this is a remote office, where a handful of employees need to join the protected network at headquarters.  When a group of computers (a network) establish a VPN connection to a server, the group of computers is said to be a <emphasis>site</emphasis>.  A given &eg; can act as a VPN server, allowing remote clients or sites to connect to the exported internal resources.  An &eg; can also act as a remote site, bridging the internal network at that remote location to an &eg; acting as a VPN server.
    </para>     
    <para>
      As a convienence when configuring the Open VPN Appliance, the following is a list of definitions used throughout the Open VPN Appliance Administrative interface.
    </para>
    <variablelist id="openvpn_tran_overview_terms">
      <title>Common Open VPN Terms</title>
      <varlistentry>
        <term><guilabel>VPN Client</guilabel></term>
        <listitem>
          <para>
            A single host (machine) which is capable of establishing a VPN connection to an &eg;.  Each VPN client authenticates via a secure key unique to that client.
          </para>
        </listitem>
      </varlistentry>        
      <varlistentry>
        <term><guilabel>VPN Site</guilabel></term>
        <listitem>
          <para>
            Another &eg; which can connect to a Open VPN Appliance acting as a VPN server.  A VPN site can represent many individual hosts (machines) within its protected network.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><guilabel>Exported Address</guilabel></term>
        <listitem>
          <para>
            The <glossterm linkend="gloss_ip_addr">IP Address</glossterm> of a host (machine) within the protected network which will be visible to VPN clients or sites after they establish a VPN connection.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><guilabel>Exported Network</guilabel></term>
        <listitem>
          <para>
            A range of addresses (expressed as a <glossterm linkend="gloss_subnet">subnet</glossterm>) within the protected network which will be visible to VPN clients or sites after they establish a VPN connection.
          </para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term><guilabel>Address Pool</guilabel></term>
        <listitem>
          <para>
            A range of <glossterm linkend="gloss_ip_addr">IP Addresses</glossterm> which will be assigned to VPN Clients as they establish a secure VPN connection.  These IP addresses are used on the internal (protected) network.  For example, <quote>Emma</quote> may VPN from their home, where her ISP has assigned her machine's IP address as <constant>10.0.0.40</constant>.  After she establishes her secure VPN connection to an &eg;, machines within the protected network may see her machine as <constant>192.1.1.4</constant>.  The address <constant>192.1.1.4</constant> came from the Address Pool configured at the Open VPN Appliance Emma has connected to.
          </para>
        </listitem>
      </varlistentry>                         
    </variablelist>
  </sect1>

  
  <sect1 id="openvpn_tran_adminui">
    <title>Administrative Interface</title>
    <para>
      The Administrative Interface for the Open VPN Appliance varies depending on your needs.  If the &eg; is to act as a client VPN site, then Administrators need only follow the wizard as described in <xref linkend="openvpn_tran_adminui_wizards_client"/>.  If the &eg; is to be used as a VPN server, exporting machines and networks to remote VPN clients and sites, Administrators must first run through the Routing Server Wizard as described in <xref linkend="openvpn_tran_adminui_wizards_server"/>.  Once configured as a Routing Server, modifications to settings can be made as described in <xref linkend="openvpn_tran_adminui_serverscreens"/>.
    </para>

    <!-- ========================================== -->
    <sect2 id="openvpn_tran_adminui_wizards">
      <title>Setup Wizards</title>
      <para>
        There are two wizards for the Administrator to walk through to configure the Open VPN Appliance, both launched from the tab shown in <xref linkend="openvpn_tran_adminui_wizards_figure"/>.
      </para>
      <figure id="openvpn_tran_adminui_wizards_figure">
        <title>Setup Wizard and Status Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/openvpn/openvpn_routing_wizard.png" />
          </imageobject>
        </mediaobject>
      </figure>      
      <para>
        The first wizard, described in <xref linkend="openvpn_tran_adminui_wizards_server"/>, is used to set-up a given &eg; as a VPN Routing Server.  If the &eg; is to be used as a remote VPN Site, then the <xref linkend="openvpn_tran_adminui_wizards_client"/> should be used.
      </para>
      <para>
        Note that one should review the basic terminology of the Open VPN appliance (see <xref linkend="openvpn_tran_overview"/>) before using the wizards.
      </para>

      <!-- *********************************************** -->
      <sect3 id="openvpn_tran_adminui_wizards_server">
        <title>Routing Server Wizard</title>
        <para>
          The Routing Server Wizard is used to configure an &eg; as a VPN server.  For a review of the Open VPN Appliance and terminology, please refer to <xref linkend="openvpn_tran_overview"/>.
        </para>

        <bridgehead renderas="sect3">Step 1</bridgehead>
        <para>
          The Routing Server Wizard consists of seven screens, which collect the configuration information required to act as a VPN server.  The wizard is launched as described in <xref linkend="openvpn_tran_adminui_wizards"/>.  Once launched, the first of seven screen should appear as seen in <xref linkend="openvpn_tran_adminui_wizards_server_figure1"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_server_figure1">
          <title>Welcome Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingwiz_1.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          The initial screen is simply introductory material.  One can then move on to step 2 which is the generation of a certificate.  This step is shown in <xref linkend="openvpn_tran_adminui_wizards_server_figure2"/>.
        </para>

        <bridgehead renderas="sect3">Step 2</bridgehead>
        <!-- ........................................... -->
        <figure id="openvpn_tran_adminui_wizards_server_figure2">
          <title>Generate Certificate Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingwiz_2.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          All information on the Generate Certificate Screen is required, and must be filled-in before proceeding to step 3.
          <note>
            <para>
              The contents of every screen in the wizard can later be revisited without launching the wizard <emphasis>except</emphasis> certificate generation.
            </para>
          </note>
          Once the required information is entered, one can proceed to step 3, as shown in <xref linkend="openvpn_tran_adminui_wizards_server_figure3"/>.
        </para>

        <bridgehead renderas="sect3">Step 3</bridgehead>
        <!-- ........................................... -->
        <para>
          The Address Pools Screen, as seen in <xref linkend="openvpn_tran_adminui_wizards_server_figure3"/> is used to create address pools.  For a review of Address Pools, please see <xref linkend="openvpn_tran_overview"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_server_figure3">
          <title>Add Address Pools Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingwiz_3.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          As address pools are an advanced feature (only needed if configuring Policies, as described in <xref linkend="policy_manager"/>, normal installations only need one address pool.
        </para>
        <para>
          Each address pool described a range of addresses, expressed in <glossterm linkend="gloss_ip_addr">address</glossterm> and <glossterm linkend="gloss_netmask">netmask</glossterm> syntax.  The complete list of fields for each entry in the address pool table are as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>Enabled</guilabel></term>
            <listitem>
              <para>
                This is a box indicating if the pool is enabled.  Disabling an address pool prevents any clients assigned to that pool from being able to establish a VPN connection.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>address pool name</guilabel></term>
            <listitem>
              <para>
                A logical name for the address pool.  Names should be chosen to be descriptive, such as <quote>partners</quote> or <quote>employees</quote>.  This name will later be used when configuring individual VPN clients.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>IP Address</guilabel></term>
            <listitem>
              <para>
                Address, used in conjunction with <guilabel>netmask</guilabel>, to define the set of addresses which will be assigned to remote clients as they join the protected network.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>netmask</guilabel></term>
            <listitem>
              <para>
                <glossterm linkend="gloss_netmask">Netmask</glossterm> used in conjunction with <guilabel>IP Address</guilabel>, to define the set of addresses which will be assigned to remote clients as they join the protected network.
                <tip>
                  <para>
                    The set of addresses defined by <guilabel>netmask</guilabel> must be large enough to handle all configured clients.  For example, a netmask of <constant>255.255.255.252</constant> allows for only 4 client addresses.  A system with 5 possible clients could not use this netmask.
                  </para>
                </tip>
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this address pool (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry>                                                                  
        </variablelist>        

        <bridgehead renderas="sect3">Step 4</bridgehead>
        <!-- ........................................... -->
        <para>
          Once at least one address pool has been created, Administrators can proceed to step 4 of the wizard, as shown in <xref linkend="openvpn_tran_adminui_wizards_server_figure4"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_server_figure4">
          <title>Add Exports Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingwiz_4.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          Step 4, Add Exports, lets Administrators define the machines and networks to be exported (visible to VPN clients and sites).  Recall from <xref linkend="openvpn_tran_overview"/> that to be useful a VPN server should export at least one network or machine.  Networks or machines are added via adding rows to the table as seen in <xref linkend="openvpn_tran_adminui_wizards_server_figure4"/>.  A complete list of the fields in the Add Exports Screen are as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>export</guilabel></term>
            <listitem>
              <para>
                When this box is checked, the resource described by the row is exported.  Resources can be temporarially hidden fro mexport by unchecking this box.  To remove an export entirely, one can simply push the remove (minus) button to the left of the table.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>host/network name</guilabel></term>
            <listitem>
              <para>
                For Administrator use only, this is a descriptive name of the exported resource (e.g. <constant>File Server</constant> or <constant>Intranet Servers</constant>).
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>IP Address</guilabel></term>
            <listitem>
              <para>
                The <glossterm linkend="gloss_ip_addr">IP address</glossterm> to be exported.  This is used in conjunction with <guilabel>netmask</guilabel> to define a single machine or a range of addresses.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>netmask</guilabel></term>
            <listitem>
              <para>
                Used with <guilabel>IP Address</guilabel>, defines a collection of addresses to be exported.
                <tip>
                  <para>
                    If you wish to export a single machine, enter that machine's IP address in <guilabel>IP Address</guilabel> and <constant>255.255.255.255</constant> as the <guilabel>netmask</guilabel>.
                  </para>
                </tip>
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this exported resource (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry>  
        </variablelist> 

        <bridgehead renderas="sect3">Step 5</bridgehead>
        <!-- ........................................... -->
        <para>
          Once one or more resources have been exported, Administrators can add zero or more VPN clients as seen in <xref linkend="openvpn_tran_adminui_wizards_server_figure5"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_server_figure5">
          <title>Add VPN Clients Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingwiz_5.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          The Add VPN Clients Screen is used to provision the Open VPN Appliance for zero or more VPN clients.  A complete list of the fields for each VPN client entry are as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>enabled</guilabel></term>
            <listitem>
              <para>
                If selected (<quote>checked</quote>), this allows the client to establish VPN connections.  When disabled, clients cannot connect.  Note that clients may be enabled/disabled without having to re-provision their keys.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>client name</guilabel></term>
            <listitem>
              <para>
                A descriptive name of the intended client.  In most cases, this is the machine's host name (e.g. <constant>escott</constant> or <constant>sales_laptop_2</constant>).
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>address pool</guilabel></term>
            <listitem>
              <para>
                The Address Pool to which this client will be assigned.  For more information on Address Pools, please review <xref linkend="openvpn_tran_overview"/>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>secure key distribution</guilabel></term>
            <listitem>
              <para>
                (this field is disabled while using the wizard)
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this VPN client (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry> 
        </variablelist>         

        <bridgehead renderas="sect3">Step 6</bridgehead>
        <!-- ........................................... -->
        <para>
          Once zero or more VPN clients have been added to the system, Administrators can optionaly add remote VPN Sites as seen in <xref linkend="openvpn_tran_adminui_wizards_server_figure6"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_server_figure6">
          <title>Add VPN Sites Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingwiz_6.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          Recall from <xref linkend="openvpn_tran_overview"/> that a remote VPN site is another &eg; acting to connect a network to a VPN server (as in the satalite office case).  A complete list of the fields for each VPN site entry is as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>enabled</guilabel></term>
            <listitem>
              <para>
                If selected (<quote>checked</quote>), this allows the remote VPN site to establish VPN connections.  When disabled, the site cannot connect.  Note that sites may be enabled/disabled without having to re-provision their keys.
              </para>
            </listitem>
          </varlistentry>        
          <varlistentry>
            <term><guilabel>site name</guilabel></term>
            <listitem>
              <para>
                A descriptive name of the site, for Administrator reference (e.g. <constant>san_mateo_sales_office</constant>).
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>address pool</guilabel></term>
            <listitem>
              <para>
                The Address Pool to which the remote &eg; itself will be assigned.  Administrators will rarely act on this pool data, so it can be assigned to the general (default) pool.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>network address</guilabel></term>
            <listitem>
              <para>
                An <glossterm linkend="gloss_ip_addr">IP address</glossterm> defining the start of the remote network.  This is used in conjunction with <guilabel>netmask</guilabel> to define the range of addresses expected from machines hosted by the remote &eg; acting as a VPN site.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>netmask</guilabel></term>
            <listitem>
              <para>
                A <glossterm linkend="gloss_netmask">netmask</glossterm> defining the size of the remote network.  This is used in conjunction with <guilabel>network address</guilabel> to define the range of addresses expected from machines hosted by the remote &eg; acting as a VPN site.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>secure key distribution</guilabel></term>
            <listitem>
              <para>
                (this field is disabled while using the wizard)
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this VPN client (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry> 
        </variablelist>          


        <bridgehead renderas="sect3">Step 7</bridgehead>
        <!-- ........................................... -->
        <para>
          Once any remote VPN sites are configured, the wizard is complete and the system is ready to accept the new configuration.  Administrators should proceed to step 7 and push the <guilabel>finish</guilabel> button as seen in <xref linkend="openvpn_tran_adminui_wizards_server_figure7"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_server_figure7">
          <title>Final Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingwiz_7.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          TODO
        </para>                                         
      </sect3>

      <!-- *********************************************** -->
      <sect3 id="openvpn_tran_adminui_wizards_client">
        <title>Client Site Wizard</title>
        <para>
          The Client Site Wizard is used to configure an &eg; as a remote VPN site, providing a route for one or more machines within its internal network.  For a review of the Open VPN Appliance and terminology, please refer to <xref linkend="openvpn_tran_overview"/>.
        </para>

        <!-- ........................................... -->
        <para>
          The Client Site Wizard consists of three screens, which collect the configuration information required to act as a VPN server.  The wizard is launched as described in <xref linkend="openvpn_tran_adminui_wizards"/>.  Once launched, the first of three screen should appear as seen in <xref linkend="openvpn_tran_adminui_wizards_client_figure1"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_client_figure1">
          <title>Welcome Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingclient_1.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          The initial screen is simply introductory material.  One can then move on to step 2 which is the installation of configuration information.  This step is shown in <xref linkend="openvpn_tran_adminui_wizards_client_figure2"/>.
        </para>

        <!-- ........................................... -->
        <figure id="openvpn_tran_adminui_wizards_client_figure2">
          <title>Download Configuration Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingclient_2.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          The configuration information can be entered in one of two ways.  The first is via network, and requires the <guilabel>Server IP Address</guilabel> and <guilabel>Password</guilabel>.  These values were emailed to an email address as described in <xref linkend="openvpn_tran_adminui_serverscreens_vpnsites"/>.  
        </para>
        <para>
          The alternative mechanism for configuration distribution is via USB key.  As with the first distribution mechanism, configuration is written to USB key as described in <xref linkend="openvpn_tran_adminui_serverscreens_vpnsites"/>.
        </para>

        <!-- ........................................... -->
        <para>
          Once the configuration information has been entered, Administrators can complete the process and save settings by puching the <guilabel>finish</guilabel> button as seen in <xref linkend="openvpn_tran_adminui_wizards_client_figure3"/>.
        </para>
        <figure id="openvpn_tran_adminui_wizards_client_figure3">
          <title>Final Screen</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routingclient_3.png" />
            </imageobject>
          </mediaobject>
        </figure>      
        <para>
          TODO
        </para>                     
      </sect3>      
    </sect2>

    <!-- ========================================== -->
    <sect2 id="openvpn_tran_adminui_serverscreens">
      <title>Administration as a Routing Server</title>
      <para>
        To configure an &eg; as a Routing Server, Administrators must first have run through the corresponding wizard, as described in <xref linkend="openvpn_tran_adminui_wizards_server"/>.  
      </para>
      <para>
        Once configured, address pools can be added or removed as described in <xref linkend="openvpn_tran_adminui_serverscreens_addrpools"/>.  Hosts and Machines can be exported as described in <xref linkend="openvpn_tran_adminui_serverscreens_exportedhosts"/>.  Finally, VPN clients and sites can be added or removed as discussed in <xref linkend="openvpn_tran_adminui_serverscreens_vpnclients"/> and <xref linkend="openvpn_tran_adminui_serverscreens_vpnsites"/> respectivly.
      </para>

      <!-- *********************************************** -->
      <sect3 id="openvpn_tran_adminui_serverscreens_addrpools">
        <title>Client and Site Address Pools</title>
        <para>
          The Client and Site Address Pools tab, as seen in <xref linkend="openvpn_tran_adminui_serverscreens_addrpools_figure"/>, lets Administrators configure pools of addresses for VPN-connected clients and sites.
        </para>
        <para>
          Most deployments will only have a single address pool (it is recommended to use the name <constant>default</constant> for this pool).  Multiple address pools should only be used if Policies wish to differentiate classes of VPN-connected users.  For a discussion of creating policies based on subnets, please refer to <xref linkend="policy_manager"/>.
        </para>

        <figure id="openvpn_tran_adminui_serverscreens_addrpools_figure">
          <title>Client and Site Address Pools Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routing_clientpools.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          Each address pool described a range of addresses, expressed in <glossterm linkend="gloss_ip_addr">address</glossterm> and <glossterm linkend="gloss_netmask">netmask</glossterm> syntax.  The complete list of fields for each entry in the address pool table are as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>Enabled</guilabel></term>
            <listitem>
              <para>
                This is a box indicating if the pool is enabled.  Disabling an address pool prevents any clients assigned to that pool from being able to establish a VPN connection.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>address pool name</guilabel></term>
            <listitem>
              <para>
                A logical name for the address pool.  Names should be chosen to be descriptive, such as <quote>default</quote> or <quote>partners</quote>.  This name will later be used when configuring individual VPN clients.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>IP Address</guilabel></term>
            <listitem>
              <para>
                Address, used in conjunction with <guilabel>netmask</guilabel>, to define the set of addresses which will be assigned to remote clients as they join the protected network.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>netmask</guilabel></term>
            <listitem>
              <para>
                <glossterm linkend="gloss_netmask">Netmask</glossterm> used in conjunction with <guilabel>IP Address</guilabel>, to define the set of addresses which will be assigned to remote clients as they join the protected network.
                <tip>
                  <para>
                    The set of addresses defined by <guilabel>netmask</guilabel> must be large enough to handle all configured clients.  For example, a netmask of <constant>255.255.255.252</constant> allows for only 4 client addresses.  A system with 5 possible clients could not use this netmask.
                  </para>
                </tip>
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this address pool (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry>                                                                  
        </variablelist>                       
        
      </sect3>

      <!-- *********************************************** -->
      <sect3 id="openvpn_tran_adminui_serverscreens_exportedhosts">
        <title>Exported Hosts and Networks</title>
        <para>
          The Exported Hosts and Networks, as seen in <xref linkend="openvpn_tran_adminui_serverscreens_exportedhosts_figure"/>, is used by Administrators to define which resources on the internal (protected) network should be visible to VPN connected clients and sites.
        </para>

        <figure id="openvpn_tran_adminui_serverscreens_exportedhosts_figure">
          <title>Exported Hosts and Networks Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routing_exportedhosts.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          Recall from <xref linkend="openvpn_tran_overview"/> that to be useful a VPN server should export at least one network or machine.  Networks or machines are added via adding rows to the table as seen in <xref linkend="openvpn_tran_adminui_serverscreens_exportedhosts_figure"/>.  A complete list of the fields in the Add Exports Screen are as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>export</guilabel></term>
            <listitem>
              <para>
                When this box is checked, the resource described by the row is exported.  Resources can be temporarially hidden from export by unchecking this box.  To remove an export entirely, one can simply push the remove (minus) button to the left of the table.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>host/network name</guilabel></term>
            <listitem>
              <para>
                For Administrator use only, this is a descriptive name of the exported resource (e.g. <constant>File Server</constant> or <constant>Intranet Servers</constant>).
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>IP Address</guilabel></term>
            <listitem>
              <para>
                The <glossterm linkend="gloss_ip_addr">IP address</glossterm> to be exported.  This is used in conjunction with <guilabel>netmask</guilabel> to define a single machine or a range of addresses.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>netmask</guilabel></term>
            <listitem>
              <para>
                Used with <guilabel>IP Address</guilabel>, defines a collection of addresses to be exported.
                <tip>
                  <para>
                    If you wish to export a single machine, enter that machine's IP address in <guilabel>IP Address</guilabel> and <constant>255.255.255.255</constant> as the <guilabel>netmask</guilabel>.
                  </para>
                </tip>
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this exported resource (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry>  
        </variablelist>               
        
      </sect3>

      <!-- *********************************************** -->
      <sect3 id="openvpn_tran_adminui_serverscreens_vpnclients">
        <title>VPN Clients</title>
        <para>
          The VPN Clients Tab, as seen in <xref linkend="openvpn_tran_adminui_serverscreens_vpnclients_figure"/>, is used by Administrators to one or more remote clients who can establish VPN connections to the &eg;.
        </para>

        <figure id="openvpn_tran_adminui_serverscreens_vpnclients_figure">
          <title>VPN Clients Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routing_vpnclients.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          Recall from <xref linkend="openvpn_tran_overview"/> that to be useful a VPN server should have at least one client or site configured (or else no one will ever use it).  A complete list of the fields for each VPN client entry are as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>enabled</guilabel></term>
            <listitem>
              <para>
                If selected (<quote>checked</quote>), this allows the client to establish VPN connections.  When disabled, clients cannot connect.  Note that clients may be enabled/disabled without having to re-provision their keys.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>client name</guilabel></term>
            <listitem>
              <para>
                A descriptive name of the intended client.  In most cases, this is the machine's host name (e.g. <constant>escott</constant> or <constant>sales_laptop_2</constant>).
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>address pool</guilabel></term>
            <listitem>
              <para>
                The Address Pool to which this client will be assigned.  For more information on Address Pools, please review <xref linkend="openvpn_tran_overview"/>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>secure key distribution</guilabel></term>
            <listitem>
              <para>
                <emphasis>This field is only enabled once a new VPN client has been saved</emphasis>.  It is an action button, allowing administrators to distribute the configuration (key) created for the remote client.  Pushing the button brings up a window asking if the configuration should be distributed via email or USB key.  When selecting <guilabel>Distribute via Email</guilabel> an email address should be entered to receive the configuration information.  When selecting <guilabel>Distribute via USB Key</guilabel>, Administrators need physical access to the &eg; machine as it will write to the USB slot.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this VPN client (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry> 
        </variablelist>                        
        
      </sect3>          

      <!-- *********************************************** -->
      <sect3 id="openvpn_tran_adminui_serverscreens_vpnsites">
        <title>VPN Sites</title>
        <para>
          The interface for configuring one or more remote VPN sites is shown in <xref linkend="openvpn_tran_adminui_serverscreens_vpnsites_figure"/>.
        </para>

        <figure id="openvpn_tran_adminui_serverscreens_vpnsites_figure">
          <title>VPN Sites Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/openvpn/openvpn_routing_vpnsites.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          Recall from <xref linkend="openvpn_tran_overview"/> that a remote VPN site is another &eg; acting to connect a network to a VPN server (as in the satalite office case).  A complete list of the fields for each VPN site entry is as follows.
        </para>
        <variablelist>
          <varlistentry>
            <term><guilabel>enabled</guilabel></term>
            <listitem>
              <para>
                If selected (<quote>checked</quote>), this allows the remote VPN site to establish VPN connections.  When disabled, the site cannot connect.  Note that sites may be enabled/disabled without having to re-provision their keys.
              </para>
            </listitem>
          </varlistentry>        
          <varlistentry>
            <term><guilabel>site name</guilabel></term>
            <listitem>
              <para>
                A descriptive name of the site, for Administrator reference (e.g. <constant>san_mateo_sales_office</constant>).
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>address pool</guilabel></term>
            <listitem>
              <para>
                The Address Pool to which the remote &eg; itself will be assigned.  Administrators will rarely act on this pool data, so it can be assigned to the general (default) pool.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>network address</guilabel></term>
            <listitem>
              <para>
                An <glossterm linkend="gloss_ip_addr">IP address</glossterm> defining the start of the remote network.  This is used in conjunction with <guilabel>netmask</guilabel> to define the range of addresses expected from machines hosted by the remote &eg; acting as a VPN site.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>netmask</guilabel></term>
            <listitem>
              <para>
                A <glossterm linkend="gloss_netmask">netmask</glossterm> defining the size of the remote network.  This is used in conjunction with <guilabel>network address</guilabel> to define the range of addresses expected from machines hosted by the remote &eg; acting as a VPN site.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>secure key distribution</guilabel></term>
            <listitem>
              <para>
                <emphasis>This field is only enabled once a new VPN site has been saved</emphasis>.  It is an action button, allowing administrators to distribute the configuration (key) created for the remote site.  Pushing the button brings up a window asking if the configuration should be distributed via email or USB key.  When selecting <guilabel>Distribute via Email</guilabel> an email address should be entered to receive the configuration information.  Since a remote VPN site is not an individual machine, it should be emailed to the &eg; Administrator for the remote site.  When selecting <guilabel>Distribute via USB Key</guilabel>, Administrators need physical access to the &eg; machine as it will write to the USB slot.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of this VPN client (for Administrator reference only)
              </para>
            </listitem>
          </varlistentry> 
        </variablelist>          
      </sect3>
    </sect2>
  </sect1>  

  <sect1 id="vpn_tran_qa">
    <title>Frequently Asked Questions</title>
    <qandaset>  
      <qandaentry>
        <question>
          <para>Where is the Q&amp;A list?</para>
        </question>
        <answer>
          <para>
            TODO Someone needs to write it.  
          </para>
        </answer>
      </qandaentry>
    </qandaset>
  </sect1>    

</chapter>
