<?xml version="1.0" encoding="UTF-8"?>
<chapter id="airgap_tran">
  <title>Packet Attack Shield</title>

  <para>
    The Packet Attack Shield is identified by the
    <inlinemediaobject>
      <imageobject>
        <imagedata fileref="figure/airgap/airgap_tran_icon.png"/>
      </imageobject>
    </inlinemediaobject>

    symbol.  If the Packet Attack Shield Appliance is not installed, please refer to <xref linkend="using_adminui_appliances"/> for installation instructions.
  </para>

  <para>
    The Packet Attack Shield Appliance protects your network in two ways.  First, it sanitizes all <glossterm linkend="gloss_packet">packets</glossterm> which traverse the &eg;.  As this is a built-in function, it has no administrative settings.
  </para>
  <para>
    Where the packet sanatizing feature protects against lower-level networking attacks, the Packet Attack Shield also protects against <glossterm linkend="gloss_dos">Denial of Service (DOS)</glossterm> attacks.  This feature is explained in more detail in <xref linkend="airgap_tran_shield_explained"/>.
  </para>
  <sect1 id="airgap_tran_shield_explained">
    <title>Denial Of Service Protection</title>
    <para>
      The Packet Attack Shield Appliance keeps track of traffic from all hosts (IP addresses).  The quantity of connections and the volume of data are monitored.  Should a given host be significantly more active than others, it's <quote>reputation</quote> increases.  Reputation is expressed as a number on a relative scale.  Higher reputation numbers intidate a given host is consuming greater resources (more connections, more bytes transferred).
    </para>
    <para>
      As the load on a given &eg; increases, the system does not have enough resources to service all requests.  Rather than <quote>slow everyone down</quote>, Packet Attack Shield Appliance begins to take action against those hosts with the greatest reputation.  In this way, hosts that are <quote>hogging all the bandwidth</quote> are forced to make due with less while <quote>normal</quote> clients see no change in service levels.  There are actualy three actions that the Packet Attack Shield Appliance can take against hosts with high reputations, enumerated in <xref linkend="airgap_tran_shield_actions"/>.
    </para>
    
    <itemizedlist id="airgap_tran_shield_actions">
      <title>Packet Attack Shield Actions</title>
      <listitem>
        <para>
        <guilabel>Limited</guilabel> - When the Packet Attack Shield Appliance causes a host's traffic to be limited, it has the effect of a mild slowdown.</para>
      </listitem>
      <listitem>
        <para>
        <guilabel>Dropped</guilabel> - When the Packet Attack Shield Appliance causes a host's traffic to be dropped, it has the effect of slowing-down traffic greater than if the traffic was simply <guilabel>limited</guilabel>.
        </para>
      </listitem>
      <listitem>
        <para>
        <guilabel>Reject</guilabel> - When the Packet Attack Shield Appliance causes a host's traffic to be rejected, it has the effect of preventing that host from communicating across the &eg;.
        </para>
      </listitem>
    </itemizedlist>  
    <para>
      This feature of limiting resources based on reputation is used to prevent Denial Of Service attacks and other forms of malicious code.  Consider the host attempting to flood a given network protected by an &eg;.  The attacking host's reputation would increase, such that their communications would move quickly from being limited to rejected.
    </para>
  </sect1>

  <sect1 id="airgap_tran_adminui">
    <title>Administrative Interface</title>
    <para>
      The Administrative Interface to the Packet Attack Shield Appliance is minimal, as most of the behavior is automatic.  The only real setting is to instruct the system that a given host should be permitted to consume extra resources when its <link linkend="airgap_tran_shield_explained">reputation</link> is computed.  This administrative setting is explained in <xref linkend="airgap_tran_exceptionlist"/>.  The Event Log tab, explained in <xref linkend="airgap_tran_eventlog"/>, allows administrators to view events (see <xref linkend="using_adminui_appliances_eventlog"/> for general information about &eg; Event Logs).
    </para>
    <!-- ======================================================== -->
    <sect2 id="airgap_tran_exceptionlist">
      <title>Exception List</title>
      <para>
        The Exception List of the Packet Attack Shield Appliance is shown in <xref linkend="airgap_tran_exceptionlist_figure"/>.
      </para>
      <figure id="airgap_tran_exceptionlist_figure">
        <title>Exception List Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/airgap/airgap_exceptionlist.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        The Exception List is used to cause a given system (<glossterm linkend="gloss_ip_addr">IP Address</glossterm>) to be treated as more than one machine.  Recall from <xref linkend="airgap_tran_shield_explained"/> that the Packet Attack Shield Appliance keeps track of the relative activity of machines on its network.  If a given address represents more than one physical machine (for example, with <glossterm linkend="gloss_nat">NAT</glossterm>), then the Packet Attack Shield Appliance must know this or it will consider the NATed network as an unusualy active single host.
      </para>
      <para>
        To add a new entry to the Exception List, push the add (plus) button to the left of the table.  This adds a new entry.  All fields and their meaning for adding/modifying exception entries is as follows.
        <variablelist>
          <varlistentry>
            <term><guilabel>enable</guilabel></term>
            <listitem>
              <para>
                If this box is checked, the exception rule is enabled.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>address</guilabel></term>
            <listitem>
              <para>
                The <glossterm linkend="gloss_ip_addr">IP Address</glossterm> of the system to receive special consideration.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>user count</guilabel></term>
            <listitem>
              <para>
                The number of users (machines) that this address should be considered to represent.  For example, if 5 users are behind a <glossterm linkend="gloss_nat">NAT</glossterm> system, the external IP address of that NAT system should receive a <guilabel>user count</guilabel> of <constant>5</constant>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>category</guilabel></term>
            <listitem>
              <para>
                A category for the entry.  This is not administrative reference only.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>description</guilabel></term>
            <listitem>
              <para>
                A description of the entry.  This is not administrative reference only.
              </para>
            </listitem>
          </varlistentry>                                        
        </variablelist>   
      </para>
    </sect2>    
    
  
    <!-- ======================================================== -->
    <sect2 id="airgap_tran_eventlog">
      <title>Event Log</title>
      <para>
        The Events tab contents is shown in <xref linkend="airgap_tran_eventlog_figure"/>.
      </para>
      <figure id="airgap_tran_eventlog_figure">
        <title>Event Log Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/airgap/airgap_eventlog.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        The Events Tab is another implementation of an Event Log, as described in <xref linkend="using_adminui_appliances_eventlog"/>.  The complete list of columns and their meaning is as follows.
        <variablelist>
          <title>Events Tab</title>
          <varlistentry>
            <term><guilabel>timestamp</guilabel></term>
            <listitem>
              <para>
                The time the event took place
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>source</guilabel></term>
            <listitem>
              <para>
                The source <glossterm linkend="gloss_ip_addr">IP address</glossterm> of the traffic.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>source interface</guilabel></term>
            <listitem>
              <para>
                The network interface on-which the traffic arrived at the &eg;.  For more information on the network interfaces of your &eg;, please refer to <xref linkend="fixme_interfaces"/>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>reputation</guilabel></term>
            <listitem>
              <para>
                XXXXX TODO XXXXXXX
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>limited</guilabel></term>
            <listitem>
              <para>
                XXXXX TODO XXXXXXX
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>dropped</guilabel></term>
            <listitem>
              <para>
                XXXXX TODO XXXXXXX
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>reject</guilabel></term>
            <listitem>
              <para>
                XXXXX TODO XXXXXXX
              </para>
            </listitem>
          </varlistentry>
        </variablelist>
      </para>      
    </sect2>
  </sect1>

  <sect1 id="airgap_tran_qa">
    <title>Frequently Asked Questions</title>
    <qandaset>  
      <qandaentry>
        <question>
          <para>Where is the Q&amp;A list?</para>
        </question>
        <answer>
          <para>
            TODO Someone needs to write it.  
          </para>
        </answer>
      </qandaentry>
    </qandaset>
  </sect1>    

</chapter>
