<?xml version="1.0" encoding="UTF-8"?>
<chapter id="nat_tran">
  <title>Router</title>

  <para>
    The Router Appliance is identified by the
    <inlinemediaobject>
      <imageobject>
        <imagedata fileref="figure/nat/nat_tran_icon.png"/>
      </imageobject>
    </inlinemediaobject>

    symbol.
    If the Router Appliance is not installed, please refer to <xref linkend="using_adminui_appliances"/> for installation instructions.
  </para>
  <para>
    The Router Appliance has two distinct configuration modes; Standard Mode and Advanced Mode.
    In Standard Mode, the Router Appliance offers features that can be configured for many common and standard deployments.
    If the features of Standard Mode are not sufficient, the Router Appliance can be switched to Advanced Mode.
    In Advanced Mode, the Router Appliance offers features that can be configured for unique deployments.
  </para>
  <para>
    In Standard Mode, the Router Appliance offers <glossterm linkend="gloss_nat">Network Address Translation (NAT)</glossterm>, <glossterm linkend="gloss_dmz">DMZ</glossterm>, Redirect, <glossterm linkend="gloss_dhcp">Dynamic Host Configuration Protocol (DHCP)</glossterm>, and <glossterm linkend="gloss_dns">Domain Name Service (DNS)</glossterm> services.
    In Advanced Mode, the Router Appliance offers Net Spaces, Routing, Redirect, <glossterm linkend="gloss_dhcp">DHCP</glossterm>, and <glossterm linkend="gloss_dns">DNS</glossterm> services.
  </para>
  <para>
    When initially installed, the Router Appliance is configured in Standard Mode.
  </para>

  <sect1 id="nat_tran_adminui">
    <title>Administrative Interface</title>
    <para>
      The Administrative Interface for the Router Appliance has seven tabs.
      The first two tabs are unique to the configuration mode of the Router Appliance.
      In Standard Mode, the first two tabs are the <glossterm linkend="gloss_nat">NAT</glossterm> and <glossterm linkend="gloss_dmz">DMZ</glossterm> tabs.
      In Advanced Mode, the first two tabs are the Net Spaces and Routing tabs.
      <note>
        <para>
          When switching from Standard Mode to Advanced Mode, the NAT and DMZ tabs are replaced by the Net Spaces and Routing tabs, respectively.
          When switching from Advanced Mode to Standard Mode, the Net Spaces and Routing tabs are replaced by the NAT and DMZ tabs, respectively.
        </para>
      </note>
    </para>
    <para>
      Each tab represents a Router feature and each feature is described in its respective section.
    </para>
    <!-- ======================================================== -->
    <sect2 id="nat_tran_nat">
      <title>NAT</title>
      <para>
        <glossterm linkend="gloss_nat">Network Address Translation (NAT)</glossterm> is a Router Appliance feature.
        The NAT feature configures the &eg; to allow multiple machines on your internal (protected) network to share access to an external network (usually the Internet) through a single <glossterm linkend="gloss_ip_addr">IP address</glossterm>.
      </para>
      <para>
        The interface for the NAT tab is shown in <xref linkend="nat_tran_nat_figure"/>.
      </para>
      <figure id="nat_tran_nat_figure">
        <title>NAT Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/nat/nat_nat.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        The NAT tab interface has three sections.
      </para>
      <para>
        The <guilabel>NAT (Network Address Translation)</guilabel> section allows the administrator to enable or disable the NAT feature.
      </para>
      <para>
        When the NAT feature is enabled, the administrator must fill in the <guilabel>Internal IP Address</guilabel> and <guilabel>Internal Subnet</guilabel> fields of the <guilabel>Internal Address (Gateway)</guilabel> section.
        The Internal IP Address is the IP address of the &eg; as seen from the internal network and the Internal Subnet is the <glossterm linkend="gloss_subnet">subnet mask</glossterm> of the Internal IP Address.
      </para>
      <para>
        When the NAT feature is disabled, none of the fields on the NAT tab are modifiable.
      </para>
      <para>
        As a convenience, the <guilabel>External Address (Public Address)</guilabel> section displays the IP address of the &eg; as seen from the external network.
        To configure the external address setting, see the discussion in <xref linkend="gblcfg_tab_networking_extaddrs"/>.
      </para>
      <para>
        After the NAT feature is configured, the administrator should configure the <glossterm linkend="gloss_dhcp">Dynamic Host Configuration Protocol (DHCP)</glossterm> feature on the &eg;.
        To configure the DHCP feature, see the discussion in <xref linkend="nat_tran_dhcp"/>.
      </para>
      <para>
        If you do <emphasis>not</emphasis> plan to use the &eg; to provide DHCP services for some or all of the machines within your internal network and instead, plan to set up NAT functionality on these machines, you must manually set the gateway address and subnet mask of these machines using the values from the <guilabel>Internal Address (Gateway)</guilabel> section of <xref linkend="nat_tran_nat_figure"/>.
      </para>
      <para>
        If you do <emphasis>not</emphasis> plan to use the &eg; to provide NAT services for your internal network, you must either:
  
        <itemizedlist>
          <listitem>
            <para>
              Have a machine outside of the &eg; appliance (on the external network) to provide NAT services
            </para>
          </listitem>
      
          <listitem>
            <para>
              Define an IP address pool.
              The IP addresses in this pool must be routable on the external network.  If the external network is the Internet, these IP addresses must be <quote>public</quote> IP addresses
            </para>
          </listitem>
        </itemizedlist>
      </para>
    </sect2>
  
    <!-- ======================================================== -->
    <sect2 id="nat_tran_dhcp">
      <title>DHCP</title>
      <para>
        <glossterm linkend="gloss_dhcp">Dynamic Host Configuration Protocol (DHCP)</glossterm> is a Router Appliance feature.
        The DHCP feature configures the &eg; to automatically assign dynamic or static <glossterm linkend="gloss_ip_addr">IP addresses</glossterm> to machines within the internal network.
        It saves many organizations time and effort since it eliminates the need for IT staff to configure the network settings of multiple machines.
        To configure the DHCP feature, see the discussions in <xref linkend="nat_tran_dhcp_settings"/> and <xref linkend="nat_tran_dhcp_addrmap"/>.

      </para>
      <para>
        The DHCP feature is often used with the <glossterm linkend="gloss_nat">Network Address Translation (NAT)</glossterm> feature, as discussed in <xref linkend="nat_tran_nat"/>.
      </para>
      <para>
        If you do <emphasis>not</emphasis> plan to use the &eg; to provide DHCP services for some or all of the machines within your internal network and instead, plan to set up NAT functionality on these machines, you must manually set the gateway address and subnet mask of these machines using the values from the <guilabel>Internal Address (Gateway)</guilabel> section of <xref linkend="nat_tran_nat_figure"/>.
      </para>
      <para>
        If you do <emphasis>not</emphasis> plan to use the &eg; to provide NAT services for your internal network, you must either:
  
        <itemizedlist>
          <listitem>
            <para>
              Have a machine outside of the &eg; (on the external network) provide NAT services.
            </para>
          </listitem>
      
          <listitem>
            <para>
              Define an IP address pool.
              The IP addresses in this pool must be routable on the external network.  If the external network is the Internet, these IP addresses must be <quote>public</quote> IP addresses.
            </para>
          </listitem>
        </itemizedlist>
      </para>
  
      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_dhcp_settings">
        <title>Settings</title>
        <para>
          The interface for the <glossterm linkend="gloss_dhcp">DHCP Settings</glossterm> tab is shown in <xref linkend="nat_tran_dhcp_settings_figure"/>.
        </para>
        <figure id="nat_tran_dhcp_settings_figure">
          <title>DHCP Settings Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_dhcp_settings.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          The DHCP Settings tab interface has two sections.
        </para>
        <para>
          The <guilabel>DHCP</guilabel> section allows the administrator to enable or disable the DHCP feature.
        </para>
        <para>
          When the DHCP feature is enabled, the administrator must fill in the <guilabel>IP Address Range Start</guilabel> and <guilabel>IP Address Range End</guilabel> fields of the <guilabel>Dynamic IP Address Range</guilabel> section.
          These fields define the IP address pool (e.g., the range of IP addresses from which the &eg; assigns dynamic IP addresses); the IP Address Range Start specifies the first IP address of the IP address pool and the IP Address Range End specifies the last IP address of the IP address pool.
        </para>
        <para>
          
        </para>
      </sect3>
  
  
      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_dhcp_addrmap">
        <title>DHCP Address Map</title>
        <para>
          The interface for the <glossterm linkend="gloss_dhcp">DHCP</glossterm> Address Map tab is shown in <xref linkend="nat_tran_dhcp_addrmap_figure"/>.
        </para>
        <figure id="nat_tran_dhcp_addrmap_figure">
          <title>DHCP Address Map Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_dhcp_addrmap.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          When the DHCP feature is enabled, the DHCP Address Map has two functions.
          The map lists the networking information of all machines that are currently receiving DHCP service from the &eg;.
          The map can also be used to create a rule to assign a static <glossterm linkend="gloss_ip_addr">IP address</glossterm> to a specific machine.
        </para>
        <para>
          When a machine connects to the internal network, by default, the DHCP feature assigns an arbitrary IP address to the machine from the IP address pool.
          Generally, this arbitrary IP address assignment is acceptable behavior.
          In limited cases, however, a machine must receive the same IP address every time that it connects.
          When the administrator needs to override the default IP address assignment behavior, the administrator adds an entry to the DHCP Address Map and the DHCP feature will ensure that the specified machine will always be assigned the same IP address.
        </para>
        <para>
          To create a static IP address assignment rule, push the add (plus) button as seen in <xref linkend="nat_tran_dhcp_addrmap_figure"/>.
          This creates a new row in the DHCP Address Map table.
          The administrator must then specify values for the <guilabel>MAC address</guilabel> and <guilabel>target static IP address</guilabel> fields and optionally specify values for the <guilabel>category</guilabel> and <guilabel>description</guilabel> fields.

          <tip>
            <para>
              After a new rule is added, sample values for the MAC address and IP address are populated in their respective fields.
              These sample values <emphasis>must</emphasis> be changed to the target machine's actual values.
            </para>
          </tip>
          <tip>
            <para>
              You can obtain the target machine's MAC address without looking it up.
              Let the machine join the internal network and through its default behavior, let the DHCP feature assign a dynamic IP address to the target machine.
              To reassign the target machine's IP address and change it to the desired static IP address, access the DHCP Address Map, find the rule for the target machine, and enter the desired static IP address in the <guilabel>target static IP address</guilabel> field.
              After hitting the <guilabel>Save Settings</guilabel> button, the IP address reassignment takes affect and becomes permanent.
            </para>
          </tip> 
          
        </para>
        <para>
          The complete list of fields for a dynamic/static IP address assignment rule is as follows.
          <variablelist>
            <varlistentry>
              <term><guilabel>MAC address</guilabel></term>
              <listitem>
                <para>
                  This fields specifies the MAC address (machine) that received DHCP services.
                  A value is automatically populated for a dynamically-assigned IP address rule.
                  A value must be entered for a statically-assigned IP address rule.
                </para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term><guilabel>target static IP address</guilabel></term>
              <listitem>
                <para>
                  This field specifies the static IP address that the DHCP feature will assign to a machine.
                  A value must be entered for a statically-assigned IP address rule.
                </para>
                <para>
                  This field is blank when a machine is assigned a dynamic IP address and <emphasis>only</emphasis> contains a value when an Administrator enters a value because this machine needs to be assigned a static IP address.
                </para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term><guilabel>current IP address</guilabel></term>
              <listitem>
                <para>
                  This field specifies the dynamic or static IP address that is currently assigned to a machine.
                  A value is automatically populated.
                </para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term><guilabel>current hostname</guilabel></term>
              <listitem>
                <para>
                  This field specifies the hostname of a machine.
                  If available, a value is automatically populated.
                  Note that some machines do not advertise their hostnames so this field can be blank.
                </para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term><guilabel>current lease end</guilabel></term>
              <listitem>
                <para>
                  This field specifies when a machine's DHCP lease expires.
                  A value is automatically populated.
                </para>
              </listitem>
            </varlistentry>                                        
            <varlistentry>
              <term><guilabel>category</guilabel></term>
              <listitem>
                <para>
                  This field specifies an administrator-defined label.
                  A value is optional (a value can be entered or left blank).
                </para>
              </listitem>
            </varlistentry>                                        
          </variablelist>
        </para>
      </sect3>    
    </sect2>
  
    <!-- ======================================================== -->
    <sect2 id="nat_tran_redirect">
      <title>Redirect</title>
      <para>
        <glossterm linkend="gloss_redirect">Redirect</glossterm> is a Router Appliance feature.
        The redirect feature configures the &eg; to redirect traffic, that matches certain criteria, from an <glossterm linkend="gloss_ip_addr">IP address</glossterm> to another IP address or from an IP address:<glossterm linkend="gloss_port">port</glossterm> to another IP address:port.
        Traffic can be redirected across any of the &eg;'s network interfaces.
        For information about the &eg;'s network interfaces, see the discussion in <xref linkend="getting_started_interfaces"/>.
      </para>
      <para>
          The interface for the Redirect tab is shown in <xref linkend="nat_tran_redirect_figure"/>.
      </para>
      <figure id="nat_tran_redirect_figure">
        <title>Redirect Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/nat/nat_redirect.png" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>
        To create a redirect rule, push the add (plus) button as seen in <xref linkend="nat_tran_redirect_figure"/>.
        This creates a new row in the Redirect table.
        By specifying the source and destination interfaces, IP addresses, and ports, the administrator defines the criteria by which the &eg; can identify traffic.
      </para>
      <para>
        The complete list of fields for a redirect rule is as follows.
        <variablelist>
          <varlistentry>
            <term><guilabel>Number (#)</guilabel></term>
            <listitem>
              <para>
                This field is a number that specifies the priority of this rule relative to other rules.
                Rule #1 is evaluated first, followed by rule #2, et cetera.
                For each new connection, the Router Appliance evaluates the traffic against active rules until a match (if any) is found.
                When a match is made, the traffic is redirected as specified by the rule.
              </para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term><guilabel>redirect</guilabel></term>
            <listitem>
              <para>
                This field enables/disables a rule's redirect functionality.
                Checking the <guilabel>redirect</guilabel> box enables the rule and the &eg; will redirect traffic that matches this active rule.
                Unchecking the <guilabel>redirect</guilabel> box disables the rule.
                Except when auditing network traffic, the <guilabel>redirect</guilabel> box is checked.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>log</guilabel></term>
            <listitem>
              <para>
                This field enables/disables a rule's auditing functionality.
                Checking the <guilabel>log</guilabel> box enables the rule and the &eg; will log information about traffic that matches this active rule.
                Unchecking the <guilabel>log</guilabel> box disables the rule.
                The information that is logged can be found in the EdgeReports and Event Log.
                For information about EdgeReports, see the discussion in <xref linkend="getting_started_interfaces"/>.
                For information about the Event Log, see the discussion in <xref linkend="nat_tran_eventlog"/>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>traffic type</guilabel></term>
            <listitem>
              <para>
                This field specifies the network protocol of the traffic to scan.
                Valid values are <glossterm linkend="gloss_tcp"><constant>TCP</constant></glossterm>, <glossterm linkend="gloss_udp"><constant>UDP</constant></glossterm>, <glossterm linkend="gloss_ping"><constant>PING</constant></glossterm> or <constant>TCP &amp; UDP</constant>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>source interface</guilabel></term>
            <listitem>
              <para>
                This field specifies the interface from which the &eg; receives traffic.
                Valid values are <constant>External</constant>, <constant>Internal</constant>, or <constant>DMZ</constant>.
                For information about the &eg;'s network interfaces, see the discussion in <xref linkend="getting_started_interfaces"/>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>destination interface</guilabel></term>
            <listitem>
              <para>
                This field specifies the interface to which the &eg; forwards traffic if the traffic <emphasis>is not</emphasis> redirected.
                Valid values are <constant>External</constant>, <constant>Internal</constant>, or <constant>DMZ</constant>.
                For information about the &eg;'s network interfaces, see the discussion in <xref linkend="getting_started_interfaces"/>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>source address</guilabel></term>
            <listitem>
              <para>
                This field specifies the source IP address of the traffic.
                Valid values are in <link linkend="appendix_syntax_ipmatcher">IP Matcher</link> format.  
                Note that IP Matcher supports the value <quote><constant>any</constant></quote>.
                Specifying a value of <constant>any</constant> means that the <guilabel>source address</guilabel> is effectively removed as a traffic selection criteria.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>destination address</guilabel></term>
            <listitem>
              <para>
                This field specifies the destination IP address of the traffic if the traffic <emphasis>is not</emphasis> redirected.
                Valid values are in <link linkend="appendix_syntax_ipmatcher">IP Matcher</link> format.  
                Note that IP Matcher supports the value <quote><constant>any</constant></quote>.
                Specifying a value of <constant>any</constant> means that the <guilabel>destination address</guilabel> is effectively removed as a traffic selection criteria.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>source port</guilabel></term>
            <listitem>
              <para>
                This field specifies the source port of the traffic.
                Valid values are in <link linkend="appendix_syntax_portmatcher">Port Matcher</link> format.
                Note that Port Matcher supports the value <quote><constant>any</constant></quote>.
                Specifying a value of <constant>any</constant> means that the <guilabel>source port</guilabel> is effectively removed as a traffic selection criteria.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>destination port</guilabel></term>
            <listitem>
              <para>
                This field specifies the destination port of the traffic if the traffic <emphasis>is not</emphasis> redirected.
                Valid values are in <link linkend="appendix_syntax_portmatcher">Port Matcher</link> format.
                Note that Port Matcher supports the value <quote><constant>any</constant></quote>.
                Specifying a value of <constant>any</constant> means that the <guilabel>destination port</guilabel> is effectively removed as a traffic selection criteria.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>redirect address</guilabel></term>
            <listitem>
              <para>
                This field specifies the destination IP address of the traffic if the traffic <emphasis>is</emphasis> redirected.
                Valid values are in <link linkend="appendix_syntax_simpleipaddr">Simple IP address</link> format or can be the literal value <constant>unchanged</constant>.
                The literal value <constant>unchanged</constant> means <quote>leave the IP address as is</quote>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>redirect port</guilabel></term>
            <listitem>
              <para>
                This field specifies the destination port of the traffic if the traffic <emphasis>is</emphasis> redirected.
                Valid values are in <link linkend="appendix_syntax_simpleport">Simple Port</link> format or can be the literal value <constant>unchanged</constant>.
                The literal value <constant>unchanged</constant> means <quote>leave the port as is</quote>.
              </para>
            </listitem>
          </varlistentry>
        </variablelist>

      </para>
      <simplesect>
        <title>Relationship with DMZ Host</title>
        <para>
          Note that the <glossterm linkend="gloss_redirect">DMZ</glossterm> feature is a <quote>catch all</quote> for inbound traffic sent from the external network.
          The DMZ feature is a special case of the Redirect feature and it redirects all traffic to a specific host, <emphasis>unless a redirect rule is active and traffic matches the active rule</emphasis>.
          The DMZ feature, for example, can be used in deployments where a web server is hosted within the internal (protected) network but must be accessible from outside your internal network.
          For more information about the DMZ feature, see the discussion in <xref linkend="nat_tran_dmzhost"/>.  
        </para>
      </simplesect>
    </sect2>
  
  
    <!-- ======================================================== -->
    <sect2 id="nat_tran_dmzhost">
      <title>DMZ</title>
      <para>
        <glossterm linkend="gloss_redirect">DMZ</glossterm> is a Router Appliance feature and is a special case of the Redirect feature.
        The DMZ feature redirects all traffic, that are destined to the external address of the &eg;, to a specific host inside the internal network, <emphasis>unless a redirect rule is active and traffic matches the active rule</emphasis>.
      </para>
      <para>
        The interface for the DMZ tab is shown in <xref linkend="nat_tran_dmzhost_figure"/>.
      </para>
      <figure id="nat_tran_dmzhost_figure">
        <title>DMZ Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/nat/nat_dmzhost.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        The DMZ tab interface has three sections.
      </para>
      <para>
        The <guilabel>DMZ Host</guilabel> section allows the administrator to enable or disable the DMZ feature.
      </para>
      <para>
        When the DMZ feature is enabled, the administrator must fill in the <guilabel>Target IP Address</guilabel> field of the <guilabel>Target Address</guilabel> section.
        The Target IP Address is the <glossterm linkend="gloss_ip_addr">IP address</glossterm> of the machine that will receive the traffic that is redirected by the DMZ feature.
      </para>
      <para>
        The <guilabel>DMZ Logging</guilabel> section allows the administrator to enable or disable the DMZ auditing functionality.
        When the DMZ Logging feature is enabled, the &eg; logs information about the redirected traffic.
        For information about the Event Log, please refer to <xref linkend="nat_tran_eventlog"/>.
      </para>
    </sect2>
  
    <!-- ======================================================== -->
    <sect2 id="nat_tran_dnsfwd">
      <title>DNS</title>
      <para>
        <glossterm linkend="gloss_dns">Domain Name Service (DNS)</glossterm> is a Router Appliance feature.
        The DNS feature configures the &eg; as a DNS server for the internal (protected) network.
        To configure the DNS feature, see the discussions in <xref linkend="nat_tran_dnsfwd_settings"/> and <xref linkend="nat_tran_dnsfwd_addrmap"/>.
      </para>
  
      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_dnsfwd_settings">
        <title>DNS Settings</title>
        <para>
          The interface for the <glossterm linkend="gloss_dns">DNS</glossterm> Settings tab is shown in <xref linkend="nat_tran_dnsfwd_settings_figure"/>.
        </para>
        <figure id="nat_tran_dnsfwd_settings_figure">
          <title>DNS Settings Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_dnsfwd_settings.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          The DNS Settings tab interface has two sections.
        </para>
        <para>
          The <guilabel>DNS Forwarding</guilabel> section allows the administrator to enable or disable the DNS feature.
        </para>
        <para>
          When the DNS feature is enabled, the administrator must fill in the <guilabel>Suffix</guilabel> field in the <guilabel>Domain Name Suffix</guilabel> section.
          This field contains the domain name suffix (e.g. <constant>acme.com</constant>) of your organization.
          It is used to ensure that a machine, on the internal network, can be accessed by its fully qualified hostname (e.g., <constant>host1.acme.com</constant>).
          It is also appended to the unqualified hostname of each machine, on the internal network, that is listed in the DNS Address Map and the DHCP Address Map.
          <note>
            <para>
              If the <guilabel>Suffix</guilabel> field is not filled in, problems may occur when certain versions of Microsoft Windows servers resolves a hostname.
            </para>
          </note>
        </para>
        <para>
          When the <glossterm linkend="gloss_dhcp">DHCP</glossterm> feature (see <xref linkend="nat_tran_dhcp"/>) is enabled, the DHCP feature will use the hostname of an internal machine to resolve the internal machine's IP address.
          When the DHCP feature is disabled, internal machines must use the internal IP address and internal subnet of their &eg; (see <xref linkend="nat_tran_nat"/>).
        </para>
      </sect3>
  

      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_dnsfwd_addrmap">
        <title>DNS Address Map</title>
        <para>
          The interface for the <glossterm linkend="gloss_dns">DNS</glossterm> Address Map tab is shown in <xref linkend="nat_tran_dnsfwd_addrmap_figure"/>.
        </para>
        <figure id="nat_tran_dnsfwd_addrmap_figure">
          <title>DNS Address Map Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_dnsfwd_addrmap.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          The DNS Address Map feature is an advanced feature.
          When the DNS feature is enabled and a machine on the internal network does not have a DNS lookup entry, the DNS Address Map allows an administrator to create a rule to translate the hostname of this machine into an IP address that other machines can lookup.
        </para>
        <para>
          To create a hostname translation rule, push the add (plus) button as seen in <xref linkend="nat_tran_dnsfwd_addrmap_figure"/>.
          This creates a new row in the DNS Address Map table.
          The administrator must then specify values for the <guilabel>translate this hostname</guilabel> and <guilabel>into this IP address</guilabel> fields.
        </para>
        <para>
          The complete list of fields for a hostname translation rule is as follows.
        </para>

        <variablelist>
          <varlistentry>
            <term><guilabel>translate this hostname</guilabel></term>
            <listitem>
              <para>
                This field is the hostname of an internal machine that needs its IP address to be manually specified.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>into this IP address</guilabel></term>
            <listitem>
              <para>
                This field specifies the IP address for the respective hostname.
                Valid values are in <link linkend="appendix_syntax_simpleipaddr">Simple IP address</link> format.
              </para>
            </listitem>
          </varlistentry>
        </variablelist>

      </sect3>    
    </sect2>

    <!-- ======================================================== -->
    <sect2 id="nat_tran_advanced">
      <title>Advanced</title>
      <para>
        The Advanced tab allows an administrator to switch between the Standard or Advanced Mode of the Router Appliance.
      </para>
      <para>
        The interface for the Advanced tab is shown in <xref linkend="nat_tran_advanced_figure"/>.
      </para>
      <figure id="nat_tran_advanced_figure">
        <title>Advanced Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/nat/nat_advanced.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        The Advanced tab interface has two sections.
      </para>
      <para>
        The <guilabel>Current Mode</guilabel> section shows the current configuration mode of the Router Appliance.
        Valid values are <constant>Standard</constant> and <constant>Advanced</constant>.
      </para>
      <para>
        When the Router Appliance is in Standard Mode, the <guilabel>Configure in Standard Mode</guilabel> button is not selectable,
        An administrator can only hit the <guilabel>Configure in Advanced Mode</guilabel> button to switch the configuration mode of the Router Appliance to Advanced Mode.
      </para>
      <para>
        When the Router Appliance is in Advanced Mode, the <guilabel>Configure in Advanced Mode</guilabel> button is not selectable,
        An administrator can only hit the <guilabel>Configure in Standard Mode</guilabel> button to switch the configuration mode of the Router Appliance to Standard Mode.
      </para>
      <note>
        <para>
          Switching from Standard Mode to Advanced Mode does not affect (e.g., change) your existing (e.g., current) settings.
          However, switching from Advanced Mode to Standard Mode does affect (e.g., reset) your existing settings.
        </para>
      </note>
    </sect2>

    <!-- ======================================================== -->
    <sect2 id="nat_tran_netspaces">
      <title>Net Spaces</title>
      <para>
        A Network Space is an abstraction and represents a network of machines that are bound to a physical (e.g., ethernet) interface, or to a group of interfaces.
        If multiple interfaces are mapped to a single network space, the Router Appliance logically binds these interfaces together as if they were connected to the same switch.
      </para>
      <para>
        The Router Appliance defines one default Network Space; the Public Space.
        The Public Space represents the external network of machines that are bound to the &eg;'s External interface.
      </para>
      <para>
        The configuration settings of a Network Space specify what will happen to traffic that tries to exit the Network Space.
        If the Traffic Forwarding feature is enabled, traffic is allowed to exit a Network Space, otherwise, traffic is prevented from entering or exiting the Network Space.
      </para>
      <para>
        If traffic is allowed to exit and the <glossterm linkend="gloss_nat">NAT</glossterm> feature is enabled, the source <glossterm linkend="gloss_ip_addr">IP address</glossterm> of the traffic can be changed to a new IP address, if one is specified; if a new IP address is not specified, the source IP address is left unchanged.
      </para>
      <note>
        <para>
          The Net Spaces tab replaces the NAT tab (see <xref linkend="nat_tran_nat"/>) when the Router Appliance is switched from Standard Mode to Advanced Mode.
        </para>
      </note>

      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_netspaces_intf2space">
        <title>Interface-To-Space Map</title>
        <para>
          The interface for the Net Spaces Interface-To-Space Map tab is shown in <xref linkend="nat_tran_netspaces_intf2space_figure"/>.
        </para>
        <figure id="nat_tran_netspaces_intf2space_figure">
          <title>Net Spaces Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_netspaces_intf2space.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          The Net Spaces Interface-To-Space Map associates a physical (e.g., ethernet) interface to a custom Network Space.
          Note that only those physical interfaces (that are present) can be mapped to Network Spaces (that have been created).
          The Internal interface is always present and can be mapped to a custom Network Space.
          (In this case, the value of the <guilabel>map this ethernet interface</guilabel> field contains the value <guilabel>Internal</guilabel>.)
          The DMZ interface may be present and if it is, can be mapped to a custom Network Space.
          (In this case, the value of the <guilabel>map this ethernet interface</guilabel> field contains the value <guilabel>DMZ</guilabel>.)
        </para>
        <para>
          For each physical interface that is present, an administrator is presented with an unique row in the Net Spaces Interface-to-Space Map table.
          An administrator maps each physical interface to a custom Network Space by selecting a value from the list of custom Network Spaces offered by the <guilabel>to this net space</guilabel> field.
        </para>
      </sect3>

      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_netspaces_spacelist">
        <title>Space List</title>
        <para>
          The interface for the Net Spaces Space List Map tab is shown in <xref linkend="nat_tran_netspaces_spacelist_figure"/>.
        </para>
        <figure id="nat_tran_netspaces_spacelist_figure">
          <title>Space List Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_netspaces_spacelist.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          The Net Spaces Space List allows an administrator to name and create a custom Network Space.
        </para>
        <para>
          To name a custom Network Space, push the add (plus) button as seen in <xref linkend="nat_tran_netspaces_spacelist_figure"/>.
          This creates a new row in the Net Spaces Space List table.
          The administrator must then specify a value for the <guilabel>space name</guilabel> field.
        </para>
        <para>
          To create a custom Network Space (after it is given a name), the administrator must hit the <guilabel>Save Settings</guilabel> button.
          When a custom Network Space is created, a distinct custom Network Space tab is generated and added to the interface of the Net Spaces tab.
          This tab is identified by the name of its custom Network Space.
          For example, if a custom Network Space is named <constant>Custom</constant> and this Network Space is created, a new tab is created and identified as <guilabel>Custom (Space)</guilabel>.
        </para>
      </sect3>

      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_netspaces_publicspace">
        <title>Public (Space)</title>
        <para>
          The interface for the Net Spaces Public (Space) tab is shown in <xref linkend="nat_tran_netspaces_publicspace_figure"/>.
        </para>
        <figure id="nat_tran_netspaces_publicspace_figure">
          <title>Public (Space) Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_netspaces_publicspace.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          The Net Spaces Public (Space) tab interface has two sections.
        </para>
        <para>
          The text in the <guilabel>Public Space</guilabel> section is informational and explains where to find the settings to configure the Public Space.
        </para>
        <para>
          The <guilabel>MTU (Maximum Transfer Unit)</guilabel> section allows the administrator to set the amount of data in each packet that exits the Public Space.
          The MTU size is an advanced topic and the MTU value should not changed.
        </para>
      </sect3>

      <!-- ******************************************************************* -->
      <sect3 id="nat_tran_netspaces_customspace">
        <title>Custom (Space)</title>
        <para>
          If no custom Network Spaces are created, then the interface of the Net Spaces feature only has three tabs (<guilabel>Interface-To-Space Map</guilabel>, <guilabel>Space List</guilabel>, and <guilabel>Public (Space)</guilabel>).
        </para>
        <para>
          When a custom Network Space is created, a custom Network Space tab is generated and added to the interface of the Net Spaces tab.
          This tab is identified by the name of its custom Network Space.
          For example, if a custom Network Space is named <constant>Custom</constant> and this Network Space is created, a new tab is created and identified as <guilabel>Custom (Space)</guilabel>.
        </para>
        <para>
          To simplify the rest of this discussion, assume that a custom Network Space named <constant>Custom</constant> has been named and created (as described in the above example).
        </para>
        <para>
          The interface for the Net Spaces Custom (Space) tab is shown in <xref linkend="nat_tran_netspaces_customspace_figure"/>.
        </para>
        <figure id="nat_tran_netspaces_customspace_figure">
          <title>Custom (Space) Tab</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/nat/nat_netspaces_customspace.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          The Net Spaces Custom (Space) tab interface has four sections.
        </para>
        <para>
          The <guilabel>NAT (Network Address Translation)</guilabel> section allows the administrator to enable or disable the NAT feature for this Network Space.
          When the NAT feature is enabled, the administrator can select the <glossterm linkend="gloss_ip_addr">IP address</glossterm> that will replace the source IP address of traffic that exits this Network Space.
        If a replacement IP address is not selected, the source IP address of traffic that exits this Network Space is left unchanged.
        </para>
        <para>
          The <guilabel>Network Aliases</guilabel> section allows the administrator to add networks to this Network Space in <constant>IP address/netmask</constant> format.
          The Router Appliance will accept traffic for this Network Space from those networks listed in this Network Space's <guilabel>Network Aliases</guilabel> section.
        </para>
        <para>
          The <guilabel>Traffic Forwarding</guilabel> section allows the administrator to enable or disable this Network Space from sending and receiving traffic to and from other Network Spaces.
          When the Traffic Forwarding feature is disabled, this Network Space will be isolated from other Network Spaces.
        </para>
        <para>
          The <guilabel>MTU (Maximum Transfer Unit)</guilabel> section allows the administrator to set the amount of data in each packet that exits this Network Space.
          The MTU size is an advanced topic and the MTU value should not changed.
        </para>
      </sect3>

    </sect2>

    <!-- ======================================================== -->
    <sect2 id="nat_tran_routing">
      <title>Routing</title>
      <para>
        In some deployments, machines may not directly connect to the &eg; but traffic from one needs to be directed to the other.
        Using the Routing feature, an administrator can configure the &eg; to direct traffic that is destined for a network to a specific machine.
      </para>
      <note>
        <para>
          The Routing tab replaces the <glossterm linkend="gloss_dmz">DMZ</glossterm> tab (see <xref linkend="nat_tran_dmzhost"/>) when the Router Appliance is switched from Standard Mode to Advanced Mode.
        </para>
      </note>
      <para>
        The interface for the Routing tab is shown in <xref linkend="nat_tran_routing_figure"/>.
      </para>
      <figure id="nat_tran_routing_figure">
        <title>Routing Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/nat/nat_routing.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        To create a routing rule, push the add (plus) button as seen in <xref linkend="nat_tran_routing_figure"/>.
        This creates a new rule in the Routing table.
        The administrator must then identify the original destination network and the new machine and optionally specify values for the <guilabel>category</guilabel> and <guilabel>description</guilabel> fields.

        <glossterm linkend="gloss_ip_addr">IP address</glossterm>

        <variablelist>
          <varlistentry>
            <term><guilabel>Number (#)</guilabel></term>
            <listitem>
              <para>
                This field is a number that specifies the priority of this rule relative to other rules.
                Rule #1 is evaluated first, followed by rule #2, et cetera.
                For each new connection, the Router Appliance evaluates the traffic against active rules until a match (if any) is found.
                When a match is made, the traffic is routed as specified by the rule.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>enable rule</guilabel></term>
            <listitem>
              <para>
                This field enables/disables a rule's routing functionality.
                Checking the <guilabel>enable rule</guilabel> box enables the rule and the &eg; will route traffic that matches this active rule.
                Unchecking the <guilabel>enable rule</guilabel> box disables the rule.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>traffic destined to this IP Network</guilabel></term>
            <listitem>
              <para>
                This field specifies the network that may have its traffic routed.
                Valid values are in <constant>IP address/netmask</constant> format.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>will be sent to this IP Address</guilabel></term>
            <listitem>
              <para>
                This field specifies the machine that may receive the traffic that is routed from the specified network.
                Valid values are in <constant>IP address</constant> format.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>category</guilabel></term>
            <listitem>
              <para>
                This field specifies an administrator-defined label.
                A value is optional (a value can be entered or left blank).
              </para>
            </listitem>
          </varlistentry>                                        
        </variablelist>

      </para>
    </sect2>

    <!-- ======================================================== -->
    <sect2 id="nat_tran_eventlog">
      <title>Event Log</title>
      <para>
        The interface for the Events Log tab is shown in <xref linkend="nat_tran_eventlog_figure"/>.
      </para>
      <figure id="nat_tran_eventlog_figure">
        <title>Event Log Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/nat/nat_eventlog.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        The Events Tab is another implementation of an Event Log, as described in <xref linkend="using_adminui_appliances_eventlog"/>.  The complete list of columns and their meaning is as follows.
        <variablelist>
          <title>Events Tab</title>
          <varlistentry>
            <term><guilabel>timestamp</guilabel></term>
            <listitem>
              <para>
                The time the event took place
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>action</guilabel></term>
            <listitem>
              <para>
                The action that was taken on the traffic.
                Valid values are <constant>dmz</constant> and <constant>redirect</constant>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>protocol</guilabel></term>
            <listitem>
              <para>
                The protocol of the traffic.
                Valid values are <glossterm linkend="gloss_tcp"><constant>TCP</constant></glossterm>, <glossterm linkend="gloss_udp"><constant>UDP</constant></glossterm>, and <glossterm linkend="gloss_ping"><constant>PING</constant></glossterm>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>source</guilabel></term>
            <listitem>
              <para>
                The source <glossterm linkend="gloss_ip_addr">IP address</glossterm> of the traffic.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>original destination</guilabel></term>
            <listitem>
              <para>
                The original <glossterm linkend="gloss_ip_addr">IP address</glossterm> of the traffic if the traffic <emphasis>is not</emphasis> redirected.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>redirected destination</guilabel></term>
            <listitem>
              <para>
                The final <glossterm linkend="gloss_ip_addr">IP address</glossterm> of the traffic if the traffic <emphasis>is</emphasis> redirected.
                When the traffic is not redirected, the final IP address is the same as the original IP address.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>reason for action</guilabel></term>
            <listitem>
              <para>
                The rule that was applied to the traffic.
                Valid values are <constant>Destined to DMZ</constant> or <constant>Redirect Rule #</constant>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>client interface</guilabel></term>
            <listitem>
              <para>
                The interface from which the &eg; received traffic.
                Valid values are <constant>External</constant>, <constant>Internal</constant>, or <constant>DMZ</constant>.
                For information about the &eg;'s network interfaces, see the discussion in <xref linkend="getting_started_interfaces"/>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>redirected server interface</guilabel></term>
            <listitem>
              <para>
                The interface to which the &eg; directed traffic.
                Valid values are <constant>External</constant>, <constant>Internal</constant>, or <constant>DMZ</constant>.
                For information about the &eg;'s network interfaces, see the discussion in <xref linkend="getting_started_interfaces"/>.
              </para>
            </listitem>
          </varlistentry>                                                                                
        </variablelist>        
      </para>
    </sect2>
  </sect1>

  <sect1 id="nat_tran_qa">
    <title>Frequently Asked Questions</title>
    <qandaset>  

      &nat_tran_qa;
      
    </qandaset>
  </sect1>    

</chapter>

