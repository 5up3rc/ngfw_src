<?xml version="1.0" encoding="UTF-8"?>
<chapter id="clamphish_tran">

  <title>PhishNet</title>

  <para>
    The PhishNet Appliance is identified by the
    <inlinemediaobject>
      <imageobject>
        <imagedata fileref="figure/clamphish/clamphish_tran_icon.png"/>
      </imageobject>
    </inlinemediaobject>
    symbol.  The PhishNet Appliance works to inspect email for <glossterm linkend="gloss_phishing">Phish</glossterm>, or fraudulent, emails.  A Phishing email is defined as follows:

    <blockquote>
      <attribution>Wikipedia</attribution>
      <para>
        In computing, phishing (also known as carding and spoofing) is a form of social engineering, characterized by attempts to fraudulently acquire sensitive information, such as passwords and credit card details, by masquerading as a trustworthy person or business in an apparently official electronic communication, such as an email. The term phishing arises from the use of increasingly sophisticated lures to "fish" for users' financial information and passwords.
      </para>
    </blockquote>

    Email transported by the <glossterm linkend="gloss_smtp">SMTP</glossterm>, <glossterm linkend="gloss_pop">POP</glossterm>, and <glossterm linkend="gloss_imap">IMAP</glossterm> protocols can be scanned for the presence of phishing emails.
  </para>
  <para>
    The PhishNet Appliance is a <link linkend="using_adminui_appliances"> Software Appliance </link>, which can be installed into multiple Virtual Racks.  For more information on configuring policies and Software Appliances, please refer to <xref linkend="policy_manager"/>.
  </para>


  <!-- ############################################################# -->
  <sect1 id="clamphish_tran_adminui">
    <title>Administrative Interface</title>

    <para>
      The interface for PhishNet is presented as four tabs.  The first three tabs are for the different email protocols that &eg; can scan.  The last tab allows administrators to view events (see <xref linkend="using_adminui_appliances_eventlog"/>).
    </para>

    <!-- ================================================================= -->
    <sect2 id="clamphish_tran_adminui_smtp">
      <title>SMTP Tab</title>
        <para>
          The SMTP tab controls how the &eg; handles emails transported over the <glossterm linkend="gloss_smtp_server">SMTP</glossterm> protocol.  Contents of this tab is shown in <xref linkend="clamphish_tran_smtp_figure"/>.
        </para>

        <figure id="clamphish_tran_smtp_figure">
          <title>SMTP Tab</title>
      
          <mediaobject>
            <imageobject>
              <imagedata fileref="figure/clamphish/clamphish_smtp.png" />
            </imageobject>
          </mediaobject>
        </figure>
        <para>
          There are four properties associated with configuring SMTP incoming/outgoing scanning, as shown in <xref linkend="clamphish_tran_smtp_figure"/>.  Detailed explanation of these follows.

          <variablelist>
            <varlistentry>
              <term><guilabel>source</guilabel></term>
              <listitem>
                <para>
                  The source of the <emphasis>email message</emphasis>.  The value <constant>incoming message</constant> refers to messages entering your network via SMTP.  This implies that there is an SMTP Server within your protected network.  The value <constant>outgoing message</constant> refers to SMTP messages is originating from within your protected network.  This could either be from your internal SMTP server or desktop SMTP clients.
                </para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term><guilabel>scan</guilabel></term>
              <listitem>
                <para>
                  This check box controls scanning for the given <constant>source</constant>.  When the box is checked, this means that the &eg; will scan email for phishing emails in that direction.
                </para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term><guilabel>action if PHISH detected</guilabel></term>
              <listitem>
                <para>
                  This controls what actions &eg; should take on the message itself, should the message be determined to be a phishing email.  There are four possible values.
                  <itemizedlist>
                    <listitem>
                      <para>
                        <constant>mark message</constant> causes the email message to have its subject changed to start with the phrase <quote><userinput>[PHISH]...</userinput></quote>.  Users can then set-up email client filter rules to cause such messages to be placed in special folders.
                      </para>
                    </listitem>
                    <listitem>
                      <para>
                        <constant>pass message</constant> causes the message to be passed on to the recipient, even though it was detected as a phishing attempt.
                      </para>
                    </listitem>
                    <listitem>
                      <para>
                        <constant>block message</constant> causes the message to be blocked, meaning the sender believes it was delivered yet it was never forwarded to the recipient.  Although neither sender nor recipient know the message was blocked, it will still be noted in the <link linkend="clamphish_tran_adminui_events">Event Log</link>
                      </para>
                    </listitem>
                    <listitem>
                      <para>
                        <constant>quarantine message</constant> causes the message to be <glossterm linkend="gloss_quarantine">quarantined</glossterm>.  For more information on the operation of this feature, please refer to <xref linkend="config_tab_quarantine"/>
                      </para>
                    </listitem>                    
                  </itemizedlist>
                </para>
              </listitem>
            </varlistentry>

            <varlistentry>
              <term><guilabel>notification if PHISH detected</guilabel></term>
              <listitem>
                <para>
                  This controls any notifications.  Notifications are net-new emails, stating that a spam message was detected at your &eg;.  There are two possible values.
                  <itemizedlist>
                    <listitem>
                      <para>
                        <constant>notify sender</constant> causes an email to be sent to the original sender of the email, informing them that they sent a phishing email.
                        <tip>
                          <para>
                            This feature should only be used for cases when you know the sender should not be sending phishing emails.  An example is a phishing email originating from within your protected network.  Such an email coming from the desktop of one of your company's employees would likely be the result of a <glossterm linkend="gloss_worm">worm</glossterm> or other virus.
                          </para>
                        </tip>                        
                      </para>
                    </listitem>
                    <listitem>
                      <para>
                        <constant>do not notify</constant> causes no notification messages to be sent.
                      </para>
                    </listitem>
                  </itemizedlist>
                </para>
              </listitem>
            </varlistentry>            
          </variablelist>
        </para>
      </sect2>

    <!-- ================================================================= -->
    <sect2 id="clamphish_tran_adminui_pop">
      <title>POP Tab</title>
      <para>
        The <glossterm linkend="gloss_pop">POP</glossterm> tab contents is shown in <xref linkend="clamphish_tran_pop_figure"/>.
      </para>
      <figure id="clamphish_tran_pop_figure">
        <title>POP Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/clamphish/clamphish_pop.png" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>
        There are three properties associated with configuring POP incoming/outgoing scanning, as shown in <xref linkend="clamphish_tran_pop_figure"/>.  Detailed explanation of these follows.

        <variablelist>
          <varlistentry>
            <term><guilabel>source</guilabel></term>
            <listitem>
              <para>
                The source of the <emphasis>email message</emphasis>.  The value <constant>incoming message</constant> means messages <emphasis>entering</emphasis> your network via POP.  This implies that the POP client is within the protected network, and the POP server is outside.  The value <constant>outgoing message</constant> means that the POP server is within the protected network, and the client is outside.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>scan</guilabel></term>
            <listitem>
              <para>
                This check box controls scanning for the given <constant>source</constant>.  When the box is checked, this means that the &eg; will scan email for phishing attempts in that direction.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>action if PHISH detected</guilabel></term>
            <listitem>
              <para>
                This controls what actions &eg; should take on the message itself, should the message be determined to be a phishing attempt.  There are two possible values.
                <itemizedlist>
                  <listitem>
                    <para>
                      <constant>mark message</constant> causes the email message to have its subject changed to start with the phrase <quote><userinput>[PHISH]...</userinput></quote>.  Users can then set-up email client filter rules to cause such messages to be placed in special folders.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      <constant>pass message</constant> causes the message to be passed on to the recipient, even though it was detected as a phishing attempt.
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </varlistentry>
        </variablelist>
      </para>
    </sect2>


    <!-- ================================================================= -->
    <sect2 id="clamphish_tran_adminui_imap">
      <title>IMAP Tab</title>
      <para>
        The <glossterm linkend="gloss_imap">IMAP</glossterm> tab contents is shown in <xref linkend="clamphish_tran_imap_figure"/>.
      </para>
      <figure id="clamphish_tran_imap_figure">
        <title>IMAP Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/clamphish/clamphish_imap.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        There are three properties associated with configuring IMAP incoming/outgoing scanning, as shown in <xref linkend="clamphish_tran_imap_figure"/>.  Detailed explanation of these follows.

        <variablelist>
          <varlistentry>
            <term><guilabel>source</guilabel></term>
            <listitem>
              <para>
                The source of the <emphasis>email message</emphasis>.  The value <constant>incoming message</constant> refers to messages entering your network via IMAP.  This implies that the IMAP client is within the protected network, and the IMAP server is outside.  The value <constant>outgoing message</constant> means that the IMAP server is within the protected network, and the client is outside.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>scan</guilabel></term>
            <listitem>
              <para>
                This check box controls scanning for the given <constant>source</constant>.  When the box is checked, this means that the &eg; will scan email for phishing emails in that direction.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>action if PHISH detected</guilabel></term>
            <listitem>
              <para>
                This controls what actions &eg; should take on the message itself, should the message be determined to be a phishing attempt.  There are two possible values.
                <itemizedlist>
                  <listitem>
                    <para>
                      <constant>mark message</constant> causes the email message to have its subject changed to start with the phrase <quote><userinput>[PHISH]...</userinput></quote>.  Users can then set-up email client filter rules to cause such messages to be placed in special folders.
                    </para>
                  </listitem>
                  <listitem>
                    <para>
                      <constant>pass message</constant> causes the message to be passed on to the recipient, even though it was detected as a phishing attempt.
                    </para>
                  </listitem>
                </itemizedlist>
              </para>
            </listitem>
          </varlistentry>
        </variablelist>
      </para>
    </sect2>

    <!-- ================================================================= -->
    <sect2 id="clamphish_tran_adminui_events">
      <title>Events Tab</title>
      <para>
        The Events tab contents is shown in <xref linkend="clamphish_tran_events_figure"/>.
      </para>
      <figure id="clamphish_tran_events_figure">
        <title>Events Tab</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="figure/clamphish/clamphish_eventlog.png" />
          </imageobject>
        </mediaobject>
      </figure>
      <para>
        The Events Tab is another implementation of an Event Log, as described in <xref linkend="using_adminui_appliances_eventlog"/>.  The complete list of columns and their meaning is as follows.
      </para>
      <para>
        <variablelist>
          <title>Events Tab</title>
          <varlistentry>
            <term><guilabel>timestamp</guilabel></term>
            <listitem>
              <para>
                The time the event took place
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>action</guilabel></term>
            <listitem>
              <para>
                The action taken on the mail.  The value depends on the mail protocol, but will contain descriptive text such as <constant>block</constant> or <constant>mark</constant>.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>client</guilabel></term>
            <listitem>
              <para>
                The client <glossterm linkend="gloss_ip_addr">IP Address</glossterm> of the protocol client.  Recall that for <glossterm linkend="gloss_smtp">SMTP</glossterm> this is the <emphasis>sender</emphasis> of the mail, and for <glossterm linkend="gloss_imap">IMAP</glossterm>/<glossterm linkend="gloss_pop">POP</glossterm> the <emphasis>receiver</emphasis> of the mail.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>subject</guilabel></term>
            <listitem>
              <para>
                The subject of the email.  This may be blank if the email had no subject.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>Receiver</guilabel></term>
            <listitem>
              <para>
                The recipient email address of the email.  
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>Sender</guilabel></term>
            <listitem>
              <para>
                The sender of the email.  Note that for phishing emails, this is almost never legitimate.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>direction</guilabel></term>
            <listitem>
              <para>
                This value is either <constant>inbound</constant> or <constant>outbound</constant>, and describes the direction of message flow.  For example, if the protocol was SMTP and this value is <constant>inbound</constant>, then the SMTP server is within the protected network and the client outside.  For IMAP/POP, <constant>inbound</constant> would indicate the client was within the protected network.
              </para>
            </listitem>
          </varlistentry>
          <varlistentry>
            <term><guilabel>server</guilabel></term>
            <listitem>
              <para>
                The server <glossterm linkend="gloss_ip_addr">IP Address</glossterm>.  Recall that for <glossterm linkend="gloss_smtp">SMTP</glossterm> this is the machine <emphasis>receiving</emphasis> the email, and for <glossterm linkend="gloss_imap">IMAP</glossterm>/<glossterm linkend="gloss_pop">POP</glossterm> the machine holding the inbox.
              </para>
            </listitem>
          </varlistentry>                                                                 
        </variablelist>
      </para>
    </sect2>
  </sect1>

  <!-- ############################################################# -->
  <sect1 id="clamphish_tran_qa">
    <title>Frequently Asked Questions</title>
    <qandaset>  

      &clamphish_tran_qa;
           
    </qandaset>
  </sect1>  

</chapter>
