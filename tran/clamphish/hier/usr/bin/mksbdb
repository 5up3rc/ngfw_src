#!/usr/bin/ruby

require 'base64'
require 'bdb'
require 'net/http'

db = BDB::Hash.open('goog-black-url.db', nil, 'w');

db["3fbf2a85c5dec5638b1c74d3cdf641b4"] = "HIPPIE!"

# Net::HTTP.start('sb.google.com', 80) do |http|
#   buf = ''
#   firstLine = true

#   http.get('/safebrowsing/update?version=goog-black-enchash:1:1') do |s|
#     buf += s;

#     if firstLine then
#       if buf =~ /^\[goog-black-enchash ([0-9.]+)\]$/ then
#         version = $1
#         puts "version #{version}"
#         firstLine = false
#         buf = $'
#       end
#     else
#       while buf =~ /^\+([^\t]+)\t([^\t]+)$/ do
#         host = $1.downcase!
#         puts "HASH: #{host}"
#         regexp = Base64.decode64($2)
#         db[host] = regexp;
#         buf = $'
#       end
#     end
#   end
# end
