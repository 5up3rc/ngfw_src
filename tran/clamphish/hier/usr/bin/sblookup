#!/usr/bin/ruby

require 'base64'
require 'bdb'
require 'digest/md5'
require 'net/http'

db = BDB::Hash.open('goog-black-url.db', nil, 'r');

def domains(host)
  a = ""
  host.split('.').reverse.map do |p|
    ret = "#{p}#{a}"
    a = ".#{ret}"
    ret
  end
end

STDIN.each_line do |host|
  domains(host.strip).each do |domain|
    hash = Digest::MD5.hexdigest("oU3q.72p#{domain}")
    result = db[hash]
    unless result.nil? then
      puts "'#{domain}' '#{hash}'"
    end
  end
end
