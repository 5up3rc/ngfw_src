<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE document
	PUBLIC "-//UJAC.org//Print Document//EN" 
	"http://ujac.sourceforge.net/ujac-print-document.dtd">

<document size="LETTER" margin-left="25" margin-right="25" margin-top="50" margin-bottom="50">
  <set-property name="linkPrefix"     type="String" value="link-"/>
  
  <font-def name="header"    family="Helvetica" size="12" style="bold"/>
  <font-def name="normal"    family="Helvetica" size="12" style="normal"/>
  <font-def name="statistic" family="Helvetica" size="11" style="normal"/>
  <font-def name="small"     family="Helvetica" size="9"  style="normal"/>
  <font-def name="title"     family="Helvetica" size="16" style="bold"/>
  <font-def name="subtitle"  family="Helvetica" size="12" style="bold"/>
  <font-def name="link"      family="Helvetica" size="12" style="italic"/>

  <style-def name="cell.normal"   halign="left"/>
  <style-def name="cell.indented" halign="left"  padding-left="10"/>
  <style-def name="cell.data"     halign="right"/>
  <style-def name="cell.link"     halign="center" font="link"/>

  <style-def name="table.summary-border" halign="center"
             border-style="top|bottom|left|right" border-width="0.5" font="normal" 
             padding-top="2" padding-bottom="7" padding-right="5" padding-left="5"/>

  <style-def name=".title"    font="title"    spacing-after="10"/>
  <style-def name=".subtitle" font="subtitle" spacing-before="10" spacing-after="10" halign="center"/>
  <style-def name=".image"    font="subtitle" spacing-after="20" halign="center"/>

  <style-def name="table.summary" font="statistic" halign="center" spacing-after="20"
             padding-top="2" padding-bottom="7" padding-right="5" padding-left="5"/>


  <header font="small">
    <header-part halign="left">
      <!-- ${reportTitle} -->
    </header-part>
  </header>

  <footer font="small">
    <footer-part padding-top="10" halign="center">
      Page ${pageNumber} of ${pageCount}
    </footer-part>
  </footer>
  
  <table halign="center" widths="9.5,9.5,41,40" width="90">
    <cell>
      <image source="${imageDirectory + iconOrganization}"/>
    </cell>
    <cell>
      <image source="${imageDirectory + iconDescription}"/>
    </cell>
    <cell valign="middle">
      <paragraph font="title">
        ${reportTitle}<br/>
        ${type} Briefing
      </paragraph>
    </cell>
    <cell valign="middle" halign="right">
      <paragraph font="small">
        ${period}
      </paragraph>
    </cell>
  </table>

  <!-- Only display the graph if one is available -->
  <if cond="${graph isDefined}">
    <paragraph class="subtitle">Visual Summary</paragraph>
    
    <paragraph class="image">
      <image halign="center" width="507" source="${imageDirectory + graph}"/>
    </paragraph>
  </if>
  
  <paragraph class="subtitle">Vital Statistics</paragraph>
  
  <set-property name="descriptionColor" type="String" value="eeeeee"/>
  <set-property name="percentColor"     type="String" value="e4e4e4"/>

  <table width="90" widths="50,37.5,12.5" halign="center" class="summary">
    
    <!-- Iterate all of the data -->
    <foreach sequence="${statistics}" loop-variable="row">
      <if cond="${row.indent == 1}">
        <set-property name="rowClass" type="String" value="indented"/>
      </if>
      <else>
        <set-property name="rowClass" type="String" value="normal"/>
      </else>
      
      <table-row>
        <cell class="${rowClass}" bgcolor="${descriptionColor}">${row.description}</cell>
        <cell class="data"        bgcolor="${descriptionColor}">${row.data}</cell>
        <cell class="data"        bgcolor="${percentColor}">${row.percent}</cell>
      </table-row>
      
      <toggle-property name="descriptionColor" type="String" a="eeeeee" b="dddddd"/>
      <toggle-property name="percentColor"     type="String" a="e4e4e4" b="d4d4d4"/>
    </foreach>
  </table>

  <set-property name="descriptionColor" type="String" value="eeeeee"/>
  <set-property name="percentColor"     type="String" value="e4e4e4"/>

  <if cond="${showDetailedReports == 'true'}">
    <paragraph class="subtitle">Detailed Reports</paragraph>

    <table width="90" widths="87.5,12.5" halign="center" class="summary">
      <!-- Iterate all of the detailed reports -->
      <foreach sequence="${detailed}" loop-variable="row">
        <table-row>
          <cell class="normal" bgcolor="${descriptionColor}">${row.description}:</cell>
          <cell halign="center" class="link"   bgcolor="${percentColor}">
            <if cond="${row.userSummaryLink == ''}">
              <!-- these reports are pre-generated pdf files
                   (for more info, see DetailedReport.xml)
               -->
              <anchor reference='${"#"+ linkPrefix + row.filename}'>
                click here
              </anchor>
            </if>
            <else>
              <!-- the "top" user summary report is not a pre-generated pdf file
                   (for more info, see DetailedReport.xml)
               -->
              <anchor reference='${"#"+ row.userSummaryLink}'>
                click here
              </anchor>
            </else>
          </cell>
        </table-row>

        <toggle-property name="descriptionColor" type="String" a="eeeeee" b="dddddd"/>
        <toggle-property name="percentColor"     type="String" a="e4e4e4" b="d4d4d4"/>
      </foreach>
    </table>
  </if>
  <else>
    <paragraph class="subtitle">Detailed Reports [disabled]</paragraph>
    <paragraph font="small" halign="center">
      To receive detailed reports enable "Include Incident Lists in
      Emails" in the "Generation" tab of Untangle Reports.
    </paragraph>
  </else>

  <!-- Clear the header, leave the footer for the page numbers -->
  <new-page>
    <header/>
    <footer>
      <footer-part padding-top="10" halign="center">
        Page ${pageNumber} of ${pageCount}
      </footer-part>
    </footer>
  </new-page>
</document>
