<?xml version="1.0" encoding="UTF-8"?>
<!-- Created using an evaluation version of JasperAssistant (http://www.jasperassistant.com) -->
<!DOCTYPE jasperReport PUBLIC "-//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">

<jasperReport name="ActiveXDetail" pageWidth="612" pageHeight="791" whenNoDataType="AllSectionsNoDetail" columnWidth="572" leftMargin="20" rightMargin="20" topMargin="30" bottomMargin="30">
    <property name="com.jasperassistant.designer.GridWidth" value="12"/>
    <property name="com.jasperassistant.designer.GridHeight" value="12"/>
    <property name="com.jasperassistant.designer.HGuides" value="109,112,204,207,493,495"/>
    <property name="com.jasperassistant.designer.DataSource" value="mvvm"/>
    <property name="com.jasperassistant.designer.SnapToGrid" value="false"/>
    <property name="com.jasperassistant.designer.Grid" value="false"/>
    <parameter name="startTime" class="java.sql.Timestamp">
    </parameter>
    <parameter name="endTime" class="java.sql.Timestamp">
    </parameter>
    <queryString><![CDATA[SELECT evt.time_stamp, name, c_client_addr, c_server_addr, c_server_port, ident, host, p2c_bytes
FROM tr_spyware_evt_activex evt
JOIN pipeline_info USING (session_id)
JOIN tr_http_evt_req USING (request_id)
JOIN addr_map ON addr = c_client_addr
WHERE evt.time_stamp > $P{startTime} AND evt.time_stamp < $P{endTime}
ORDER BY time_stamp]]></queryString>
    <field name="c_server_port" class="java.lang.Integer">
    </field>
    <field name="c_client_addr" class="java.lang.String">
    </field>
    <field name="host" class="java.lang.String">
    </field>
    <field name="name" class="java.lang.String">
    </field>
    <field name="c_server_addr" class="java.lang.String">
    </field>
    <field name="time_stamp" class="java.sql.Timestamp">
    </field>
    <field name="ident" class="java.lang.String">
    </field>
    <title>
        <band height="90">
            <staticText>
                <reportElement key="staticText" positionType="Float" mode="Opaque" x="0" y="0" width="239" height="23"/>
                <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
                <textElement>
                    <font fontName="Bitstream Vera Sans" size="18" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
                </textElement>
                <text><![CDATA[Metavize EdgeGuard]]></text>
            </staticText>
            <staticText>
                <reportElement key="staticText" positionType="Float" mode="Opaque" x="0" y="28" width="249" height="17"/>
                <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
                <textElement>
                    <font fontName="Bitstream Vera Sans" size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
                </textElement>
                <text><![CDATA[ActiveX Incidents]]></text>
            </staticText>
            <textField pattern="">
                <reportElement key="textField" mode="Opaque" x="0" y="50" width="305" height="15"/>
                <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
                <textElement>
                    <font fontName="Bitstream Vera Sans" size="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[String.format("%tB %<td, %<tY", new Object[] {new Long($P{startTime}.getTime())})
 + " to "
 + String.format("%tB %<td, %<tY", new Object[] {new Long($P{endTime}.getTime())})]]></textFieldExpression>
            </textField>
            <image>
                <reportElement key="image" positionType="Float" mode="Opaque" x="508" y="0" width="64" height="64"/>
                <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
                <graphicElement/>
                <imageExpression class="java.lang.String"><![CDATA["com/metavize/gui/icons/LogoNoText64x64.gif"]]></imageExpression>
            </image>
        </band>
    </title>
    <pageHeader>
        <band height="14">
            <printWhenExpression><![CDATA[1 < $V{PAGE_NUMBER}.intValue() ? Boolean.TRUE : Boolean.FALSE]]></printWhenExpression>
            <line>
                <reportElement positionType="Float" x="0" y="13" width="572" height="1"/>
                <graphicElement pen="2Point"/>
            </line>
            <textField>
                <reportElement positionType="Float" x="494" y="0" width="78" height="12"/>
                <textElement textAlignment="Right">
                    <font size="9" isItalic="true"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}.toString()]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement positionType="Float" x="0" y="0" width="141" height="12"/>
                <textElement>
                    <font size="9" isItalic="true"/>
                </textElement>
                <text><![CDATA[ActiveX Incidents]]></text>
            </staticText>
        </band>
    </pageHeader>
    <columnHeader>
        <band height="27">
            <line>
                <reportElement positionType="Float" x="0" y="13" width="572" height="1" forecolor="#c0c0c0"/>
                <graphicElement pen="Thin"/>
            </line>
            <line>
                <reportElement positionType="Float" x="0" y="26" width="572" height="1"/>
                <graphicElement pen="2Point"/>
            </line>
            <staticText>
                <reportElement positionType="Float" x="0" y="0" width="110" height="12"/>
                <textElement>
                    <font isItalic="true"/>
                </textElement>
                <text><![CDATA[Timestamp]]></text>
            </staticText>
            <staticText>
                <reportElement positionType="Float" x="112" y="0" width="92" height="12"/>
                <textElement>
                    <font isItalic="true"/>
                </textElement>
                <text><![CDATA[User]]></text>
            </staticText>
            <staticText>
                <reportElement positionType="Float" x="112" y="14" width="92" height="12"/>
                <textElement>
                    <font isItalic="true"/>
                </textElement>
                <text><![CDATA[Client]]></text>
            </staticText>
            <staticText>
                <reportElement positionType="Float" x="207" y="0" width="286" height="12"/>
                <textElement>
                    <font isItalic="true"/>
                </textElement>
                <text><![CDATA[ActiveX ID]]></text>
            </staticText>
            <staticText>
                <reportElement positionType="Float" x="206" y="14" width="287" height="12"/>
                <textElement>
                    <font isItalic="true"/>
                </textElement>
                <text><![CDATA[Host]]></text>
            </staticText>
            <staticText>
                <reportElement positionType="Float" x="494" y="0" width="78" height="12"/>
                <textElement>
                    <font isItalic="true"/>
                </textElement>
                <text><![CDATA[Server]]></text>
            </staticText>
            <staticText>
                <reportElement positionType="Float" x="494" y="14" width="78" height="12"/>
                <textElement>
                    <font isItalic="true"/>
                </textElement>
                <text><![CDATA[Port]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="27">
            <textField>
                <reportElement positionType="Float" x="206" y="0" width="287" height="12"/>
                <textElement>
                    <font fontName="SansSerif"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{ident}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement positionType="Float" x="112" y="0" width="92" height="12"/>
                <textElement>
                    <font fontName="SansSerif"/>
                </textElement>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{name}.equals($F{c_client_addr}) ? "" : $F{name}]]></textFieldExpression>
            </textField>
            <line>
                <reportElement positionType="Float" x="0" y="13" width="572" height="1" forecolor="#c0c0c0"/>
                <graphicElement pen="Thin"/>
            </line>
            <line>
                <reportElement positionType="Float" x="0" y="26" width="572" height="1"/>
                <graphicElement pen="Thin"/>
            </line>
            <textField>
                <reportElement positionType="Float" x="0" y="0" width="110" height="12"/>
                <textElement/>
                <textFieldExpression class="java.sql.Timestamp"><![CDATA[$F{time_stamp}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement positionType="Float" x="206" y="14" width="287" height="12"/>
                <textElement/>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{host}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement positionType="Float" x="112" y="14" width="92" height="12"/>
                <textElement/>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{c_client_addr}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement positionType="Float" x="494" y="14" width="78" height="12"/>
                <textElement/>
                <textFieldExpression class="java.lang.Integer"><![CDATA[$F{c_server_port}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement positionType="Float" x="494" y="0" width="78" height="12"/>
                <textElement/>
                <textFieldExpression class="java.lang.String"><![CDATA[$F{c_server_addr}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <summary>
        <band height="4">
            <line>
                <reportElement positionType="Float" x="0" y="0" width="572" height="1"/>
                <graphicElement pen="2Point"/>
            </line>
        </band>
    </summary>
</jasperReport>
